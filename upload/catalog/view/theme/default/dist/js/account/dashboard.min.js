!function(){angular.module("instag-app",["ngTouch"])}(),function(){jQuery.fn.center=function(relative){var relative=relative||this.parent();return this.css("position","absolute"),this.css("top",Math.max(0,($(relative).outerHeight()-$(this).outerHeight())/2+$(relative).scrollTop())+"px"),this.css("left",Math.max(0,($(relative).width()-$(this).width())/2+$(relative).scrollLeft())+"px"),this}}(),function(){function AddSourcesController($http,$compile,$scope,$rootScope){function addUsers($event,accountId,endpoint){$event.stopPropagation(),angular.element(document.getElementById("loader")).addClass("loading");var clickedElement=angular.element($event.currentTarget),userid=clickedElement.parent().find(".user-id").attr("id"),username=clickedElement.parent().find("h4").attr("data-username"),post_data={account_id:accountId,data:{}};"whitelist_users"==endpoint?(post_data.data.whitelist_users=[],post_data.data.whitelist_users[0]={id:userid,username:username}):(post_data.data.follow_source_users=[],post_data.data.follow_source_users[0]={id:userid,username:username}),$http.post("index.php?route=account/setting/edit",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){if("whitelist_users"==endpoint){userid=data.data.whitelist_users[0].id,username=data.data.whitelist_users[0].username;var listContainer=angular.element(document.getElementById("whitelist-users-list"))}else{userid=data.data.follow_source_users[0].id,username=data.data.follow_source_users[0].username;var listContainer=angular.element(document.getElementById("user-sources-list"))}var addedUsers="";if(addedUsers+='<div class="user-list '+username.replace(".","")+" "+userid+'">',addedUsers+='<a href="http://www.instagram.com/'+username+'" target="blank"><h4><img src="catalog/view/theme/default/image/dashboard/default_user.jpg" />',addedUsers+=clickedElement.parent().find("h4").html()+"</h4></a>",addedUsers+='<button class="gold-button" ng-controller="RemoveController as remove" ng-click="remove.removeFromList($event,\''+accountId+"','"+endpoint+"','"+userid+"')\">X</button>",addedUsers+="</div>",listContainer.prepend($compile(addedUsers)($scope)),"whitelist_users"===endpoint){var button='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','whitelist_users','"+userid+'\')" class="repeated-user">';button+='<i class="fa fa-check"></i>',button+="</button>",clickedElement.parent().append($compile(button)($scope)),clickedElement.remove();var usersCount=parseInt(angular.element(document.getElementById("whitelist-notification-count")).html());usersCount++,angular.element(document.getElementById("whitelist-count")).html(usersCount),angular.element(document.getElementById("whitelist-notification-count")).html(usersCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".whitelist .notification-count").html(usersCount)}else{var button='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','follow_source_users','"+userid+'\')" class="repeated-user">';button+='<i class="fa fa-check"></i>',button+="</button>",clickedElement.parent().append($compile(button)($scope)),clickedElement.remove();var usersCount=parseInt(angular.element(document.getElementById("users-notification-count")).html());usersCount++,angular.element(document.getElementById("user-sources-count")).html(usersCount),angular.element(document.getElementById("users-notification-count")).html(usersCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".users .notification-count").html(usersCount);var sourcesTable=angular.element(document.getElementById("sources-table")).find(".table-body");sourcesTable.find("."+userid).length&&sourcesTable.find("."+userid).addClass("active-source")}angular.element(document.getElementById("content")).attr("data-kickoff")&&vm.checkUsersList(listContainer)}else if(data.errors){var warningModal=angular.element(document.getElementById("list-warning"));warningModal.find(".message").html(data.errors),warningModal.addClass("displayed")}angular.element(document.getElementById("loader")).removeClass("loading")})}function addTags($event,accountId){angular.element(document.getElementById("loader")).addClass("loading");var clickedElement=angular.element($event.currentTarget),tag=clickedElement.parent().find("h4").attr("data-tag"),post_data={account_id:accountId,data:{follow_source_tags:[tag]}};$http.post("index.php?route=account/setting/edit",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var addedTags="";addedTags+='<div class="user-list '+tag.replace(".","")+'" ng-controller="RemoveController as remove">',addedTags+='<h4><i class="fa fa-hashtag"></i>',addedTags+=clickedElement.parent().find("h4").html()+"</h4>",addedTags+='<button class="gold-button" ng-click="remove.removeFromList($event,\''+accountId+"','follow_source_tags','"+data.data.follow_source_tags[0]+"')\">X</button>",addedTags+="</div>",angular.element(document.getElementById("hashtag-sources-list")).append($compile(addedTags)($scope));var button='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','follow_source_tags','"+data.data.follow_source_tags[0]+'\')" class="repeated-user">';button+='<i class="fa fa-check"></i>',button+="</button>",clickedElement.parent().append($compile(button)($scope)),clickedElement.remove();var tagsCount=parseInt(angular.element(document.getElementById("tags-notification-count")).html());tagsCount++,angular.element(document.getElementById("hashtags-count")).html(tagsCount),angular.element(document.getElementById("tags-notification-count")).html(tagsCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".hashtags .notification-count").html(tagsCount);var sourcesTable=angular.element(document.getElementById("sources-table")).find(".table-body");if(sourcesTable.find("."+data.data.follow_source_tags[0]).length&&sourcesTable.find("."+data.data.follow_source_tags[0]).addClass("active-source"),angular.element(document.getElementById("content")).attr("data-kickoff")){var listContainer=angular.element(document.getElementById("hashtag-sources-list"));vm.checkUsersList(listContainer)}}else if(data.errors){var warningModal=angular.element(document.getElementById("list-warning"));warningModal.find(".message").html(data.errors),warningModal.addClass("displayed")}angular.element(document.getElementById("loader")).removeClass("loading")})}function addLocation($event,accountId){angular.element(document.getElementById("loader")).addClass("loading");var clickedElement=angular.element($event.currentTarget),locationId=clickedElement.parent().find(".location-id").attr("id"),locationName=clickedElement.parent().find("h4").attr("data-location"),locationSubtitle=clickedElement.parent().find("h4").attr("data-subtitle"),post_data={account_id:accountId,data:{follow_source_locations:[{id:locationId,name:locationName,subtitle:locationSubtitle}]}};$http.post("index.php?route=account/setting/edit",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var location=data.data.follow_source_locations[0],locationId=location.id,charLimit=0,addedLocation="";charLimit=angular.element(window).innerWidth<760?{name:19,subtitle:21}:{name:28,subtitle:30},addedLocation+='<div class="user-list '+locationId+'" ng-controller="RemoveController as remove">',addedLocation+='<i class="fa fa-map-marker"></i>',addedLocation+='<div class="user-description">',addedLocation+="<h4>",addedLocation+=location.name.length>charLimit.name?location.name.substr(0,charLimit.name-3)+"...":location.name,addedLocation+="</h4>",addedLocation+="<p>",addedLocation+=location.subtitle.length>charLimit.subtitle?location.subtitle.substr(0,charLimit.subtitle-3)+"...":location.subtitle,addedLocation+="</p>",addedLocation+="</div>",addedLocation+='<button class="gold-button" ng-click="remove.removeFromList($event,\''+accountId+"','follow_source_locations','"+locationId+"')\">X</button>",addedLocation+="</div>",angular.element(document.getElementById("locations-sources-list")).prepend($compile(addedLocation)($scope));var button='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','follow_source_locations','"+locationId+'\')" class="repeated-user">';button+='<i class="fa fa-check"></i>',button+="</button>",clickedElement.parent().append($compile(button)($scope)),clickedElement.remove();var locationsCount=parseInt(angular.element(document.getElementById("locations-notification-count")).html());locationsCount++,angular.element(document.getElementById("locations-count")).html(locationsCount),angular.element(document.getElementById("locations-notification-count")).html(locationsCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".locations .notification-count").html(locationsCount);var sourcesTable=angular.element(document.getElementById("sources-table")).find(".table-body");if(sourcesTable.find(".l"+locationId).length&&sourcesTable.find(".l"+locationId).addClass("active-source"),angular.element(document.getElementById("content")).attr("data-kickoff")){var listContainer=angular.element(document.getElementById("locations-sources-list"));vm.checkUsersList(listContainer)}}else if(data.errors){var warningModal=angular.element(document.getElementById("list-warning"));warningModal.find(".message").html(data.errors),warningModal.addClass("displayed")}angular.element(document.getElementById("loader")).removeClass("loading")})}function checkUsersList(listContainer){$rootScope.$broadcast("checkUsersList",listContainer)}var vm=this;vm.addUsers=addUsers,vm.addTags=addTags,vm.addLocation=addLocation,vm.checkUsersList=checkUsersList}angular.module("instag-app").controller("AddSourcesController",AddSourcesController),AddSourcesController.$inject=["$http","$compile","$scope","$rootScope"]}(),function(){function BillingTabController(checkStatusService,timeAgoService,$scope,$timeout,$http,$compile,$rootScope){function updateSpeed($event){if(!vm.updateSpeedFlag&&!vm.processingPayment){vm.updateSpeedFlag=!0;var clickedElement=angular.element($event.currentTarget);clickedElement.parent().find(".selected-speed").removeClass("selected-speed"),clickedElement.addClass("selected-speed");var category=clickedElement.attr("data-category-id"),productsContainer=angular.element(document.getElementById("products"));if(productsContainer.find(".selected-category").removeClass("selected-category"),productsContainer.find("#category-"+category).addClass("selected-category"),productsContainer.find(".selected-product").length){var reference=productsContainer.find(".selected-product").attr("data-product-reference"),emulateEvent={currentTarget:productsContainer.find("#category-"+category+" .reference-"+reference)};vm.updateBilling(emulateEvent)}else vm.updateSpeedFlag=!1}}function updateBilling($event){if(!vm.updatingCart&&!vm.processingPayment){vm.updatingCart=!0;var clickedElement=angular.element($event.currentTarget);clickedElement.parent().parent().find(".selected-product").removeClass("selected-product"),clickedElement.addClass("selected-product");var speedContainer=angular.element(document.getElementById("speeds"));if(!speedContainer.find(".selected-speed").length){speedContainer.children().eq(0).addClass("selected-speed");var emulateEvent={currentTarget:speedContainer.children().eq(0)};vm.updateBilling(emulateEvent)}vm.updateCart()}}function updateCart(){if(!vm.processingPayment){var buttonConfirm=angular.element(document.getElementById("button-confirm"));buttonConfirm.attr("disabled","true");var buttonUpdate=angular.element(document.getElementById("button-update"));buttonUpdate.attr("disabled","true");var accountId=angular.element(document.getElementById("left-sidebar")).find(".current-account").attr("data-id"),productId=angular.element(document.getElementById("products")).find(".selected-product").attr("data-product-id"),code=angular.element(document.getElementById("input-coupon")).val(),post_data={account_id:accountId,product_id:productId,coupon:encodeURIComponent(code)};$http.post("index.php?route=account/billing/cart",post_data).success(function(data){data.redirect&&(window.location=data.redirect);var payment_card=angular.element(document.getElementById("payment-card"));vm.updatingCart=!1,vm.updateSpeedFlag=!1,data.order_totals&&(data.order_totals.length>0?(payment_card.find(".confirm-payment").removeClass("hidden"),payment_card.find(".update-payment").addClass("hidden")):(payment_card.find(".confirm-payment").addClass("hidden"),payment_card.find(".update-payment").removeClass("hidden")),updateOrderTotals(data),angular.element(document.getElementById("input-coupon")).attr("disabled","false"),buttonConfirm.removeAttr("disabled").html(buttonConfirm.attr("data-reset-text")),buttonUpdate.removeAttr("disabled").html(buttonUpdate.attr("data-reset-text")),angular.element(document.getElementById("input-coupon")).removeAttr("disabled"),angular.element(document.getElementById("button-coupon")).removeAttr("disabled"))})}}function updateOrderTotals(data){if(!vm.processingPayment){var dataTotals="";dataTotals+="<tbody>";for(var i=0;i<data.order_totals.length;i++)if("total"==data.order_totals[i].code)dataTotals+='<tr><td class="text-right tooltip-container"><strong><span>'+data.order_totals[i].title+"</span></strong></td>",dataTotals+='<td class="text-right"><strong>'+data.order_totals[i].text+"</strong></td></tr>";else if("coupon"==data.order_totals[i].code){var coupon=angular.element(document.getElementById("input-coupon")).val();dataTotals+='<tr><td class="text-right tooltip-container" id="coupon-total" data-coupon="'+coupon+'"><span>'+data.order_totals[i].title+"</span></td>",dataTotals+='<td class="text-right">'+data.order_totals[i].text+"</td></tr>"}else dataTotals+='<tr><td class="text-right tooltip-container"><span>'+data.order_totals[i].title+"</span></td>",dataTotals+='<td class="text-right">'+data.order_totals[i].text+"</td></tr>";dataTotals+="</tbody>",angular.element(document.getElementById("order-totals")).find(".table").empty().html(dataTotals)}}function displayCoupon($event){var clickedElement=angular.element($event.currentTarget);clickedElement.addClass("hide"),clickedElement.parent().find(".form-group").addClass("displayed")}function applyCoupon(){var code=angular.element(document.getElementById("input-coupon")).val(),post_data={coupon:encodeURIComponent(code)};$http.post("index.php?route=total/coupon/coupon",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success)vm.updateCart();else if(data.error){var alert='<div class="alert alert-danger">'+data.error+"</div>";angular.element(document.getElementById("modules")).append(alert)}})}function validatePayment($event){vm.processingPayment=!0;var productId=(angular.element($event.currentTarget),angular.element(document.getElementById("products")).find(".selected-product").attr("data-product-id")),couponCode=angular.element(document.getElementById("coupon-total")).attr("data-coupon"),post_data={account_id:angular.element(document.getElementById("left-sidebar")).find(".current-account").attr("data-id"),product_id:productId,coupon:couponCode},buttonConfirm=angular.element(document.getElementById("button-confirm")),buttonUpdate=angular.element(document.getElementById("button-update"));buttonConfirm.button("loading"),buttonUpdate.button("loading"),window.paymentAttemptsFlag<3?$http.post("index.php?route=account/billing/validate",post_data).success(function(data){data.redirect&&(window.location=data.redirect),data.success?(angular.element(document.getElementById("payment")).attr("action",angular.element(document.getElementById("payment")).attr("data-"+data.action)),$timeout(function(){angular.element(document.getElementById("payment")).find('input[type="submit"]').trigger("click")},0)):data.errors&&(angular.element(document.getElementById("billing-notifications")).html('<div class="alert alert-danger"><i class="fa fa-exclamation-circle"></i> '+data.errors.empty+"</div>"),buttonConfirm.button("reset"),buttonUpdate.button("reset"),window.paymentAttemptsFlag++)}):angular.element(document.getElementById("billing-modal")).addClass("displayed")}function validateform(formId){for(var value=!0,form=angular.element(document.getElementById(formId)),fields=form.find('input[type="text"]',"textarea"),i=0;i<fields.length;i++)""==fields.eq(i).val()&&(value=!1);return value}function checkoutResponse(data){if(data.success){var accountId=angular.element(document.getElementById("left-sidebar")).find(".current-account").attr("data-id");$http.get("index.php?route=account/billing/success&account_id="+accountId).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success)var alert='<div class="alert alert-success"><i class="fa fa-check-circle"></i> '+data.success+"</div>";for(var conversion,i=0;conversion=data.conversions[i];++i)alert+=conversion;angular.element(document.getElementById("billing-notifications")).html(alert),angular.element(document.getElementById("order-totals")).find(".table").empty().html("");var dataCard="";if(data.upcoming_orders){for(var upcomingOrder,i=0;upcomingOrder=data.upcoming_orders[i];++i){dataCard+='<tr><td class="text-left">';for(var upcomingOrderProduct,j=0;upcomingOrderProduct=upcomingOrder.products[j];++j)dataCard+="<strong>"+upcomingOrderProduct.name+"</strong>";dataCard+="<br>"+upcomingOrder.date+"</td>",dataCard+="</td>",dataCard+='<td class="text-right"><strong>'+upcomingOrder.total+"</strong><br>&nbsp;</td>",dataCard+="</tr>"}angular.element(document.getElementById("card-payments")).removeClass("hide"),angular.element(document.getElementById("payments")).find(".table").empty().append(dataCard)}for(var followSpeeds=angular.element(document.getElementById("follow-range")).find(".card-input .speed-span"),unfollowSpeeds=angular.element(document.getElementById("unfollow-range")).find(".card-input .speed-span"),newFollowSpeed=0,newUnfollowSpeed=0,i=0;i<followSpeeds.length;++i){var followSpeed=angular.element(followSpeeds[i]);data.capabilities.indexOf("speed_"+angular.element(followSpeed).attr("data-speed"))>-1?(followSpeed.data("valid","1").attr("data-valid","1"),followSpeed.data("speed-value")>newFollowSpeed&&(newFollowSpeed=parseInt(followSpeed.data("speed-value")),3==newFollowSpeed&&(angular.element(document.getElementById("follow-range")).removeClass("upgrade"),angular.element(document.getElementById("unfollow-range")).removeClass("upgrade")))):(followSpeed.data("valid","0").attr("data-valid","0"),angular.element(document.getElementById("follow-range")).addClass("upgrade"),angular.element(document.getElementById("unfollow-range")).addClass("upgrade"))}for(var i=0;i<unfollowSpeeds.length;++i){var unfollowSpeed=angular.element(unfollowSpeeds[i]);data.capabilities.indexOf("speed_"+unfollowSpeed.data("speed"))>-1?(unfollowSpeed.data("valid","1").attr("data-valid","1"),unfollowSpeed.data("speed-value")>newUnfollowSpeed&&(newUnfollowSpeed=parseInt(unfollowSpeed.data("speed-value")))):unfollowSpeed.data("valid","0").attr("data-valid","0")}var contentMsg=angular.element(document.getElementById("content")).attr("data-msg");if("expired"==contentMsg||"invalid_token"==contentMsg){var accountElement=angular.element(document.getElementById("left-sidebar")).find(".current-account"),accountId=accountElement.attr("data-id"),buttonAccount=angular.element(document.getElementById("change-status-btn"));$http.get("index.php?route=account/account/start&account_id="+accountId).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var squareStatus=accountElement.find(".account-square-status"),accountStatus=accountElement.find(".account-status"),removeClasses="reconnect kickoff stopped started start stop disabled expired loading";if(accountElement.hasClass("current-account")&&(buttonAccount.removeClass(removeClasses).addClass("started").html("Stop").attr("data-action","stop"),buttonAccount.parent().find("i").removeClass("fa-stopped").addClass("fa-started"),buttonAccount.parent().find(".item-content p").html("Started")),squareStatus.removeClass(removeClasses).addClass("started").attr("data-action","started"),accountStatus.removeClass(removeClasses).addClass("started"),window.innerWidth<1200){var headerStatus=angular.element(document.getElementById("logo-u-container")).find(".account-item .account-status");headerStatus.removeClass(removeClasses).addClass("started")}if(data.tooltip?(accountElement.find(".account-square-status").attr("data-tooltip",data.tooltip),angular.element(document.getElementById("account")).find(".account-status .account-status-icon").attr("data-tooltip",data.tooltip)):(accountElement.find(".account-square-status").attr("data-tooltip",""),angular.element(document.getElementById("account")).find(".account-status .account-status-icon").attr("data-tooltip","")),accountElement.hasClass("current-account")){var historyContent=angular.element(document.getElementById("history-content"));if(data.event){var item=vm.historyMarkup(data.event,!0);historyContent.prepend(item)}}}angular.element(document.getElementById("loader")).removeClass("loading")})}if(angular.element(document.getElementById("follow-range")).find(".input-range").val(newFollowSpeed).triggerHandler("change"),angular.element(document.getElementById("unfollow-range")).find(".input-range").val(newUnfollowSpeed).triggerHandler("change"),3==data.capabilities.length&&angular.element(document.getElementById("upgrade-ludicrous")).remove(),angular.element(document.getElementById("account-trial")).length&&angular.element(document.getElementById("account-trial")).remove(),vm.checkStatus(""),"expired"==angular.element(document.getElementById("content")).attr("data-msg")&&(angular.element(document.getElementById("account")).find(".run-status .item-content p").html(data.account_status),angular.element(document.getElementById("change-status-btn")).attr("data-action","start").html(data.button_start).removeClass("expired-button")),window.innerWidth<730){angular.element(document.getElementById("billing")).find(".collapse").removeClass("opened");var speedCollapse=angular.element(document.getElementById("billing")).find(".collapse").eq(0),speedHeader=speedCollapse.find(".collapse-header"),selectedSpeed=speedCollapse.find(".selected-speed"),selectedProduct=angular.element(document.getElementById("billing")).find(".collapse").eq(1).find(".selected-product");speedHeader.addClass("has-speed").attr("data-selected-product",selectedProduct.attr("data-product-id")),speedHeader.find(".selected-speed-container").attr("id","speed-selected-"+selectedProduct.attr("data-product-id")),speedHeader.find(".selected-speed-container").find("span").empty().html(selectedSpeed.find("h5").html());var billingCollapse=angular.element(document.getElementById("billing")).find(".collapse").eq(1),billingHeader=billingCollapse.find(".collapse-header"),selectedBilling=billingCollapse.find(".selected-product");billingHeader.addClass("has-billing").attr("data-selected-product",selectedProduct.attr("data-product-id")),billingHeader.find(".selected-billing-container").attr("billing-selected-id",selectedProduct.attr("data-product-id")),billingHeader.find(".selected-billing-container").find("span").empty().html(selectedBilling.find("h5").html())}"expired"==angular.element(document.getElementById("content")).attr("data-msg")&&(vm.checkStatus(""),angular.element(document.getElementById("left-sidebar")).find(".current-account .account-square-status").attr("data-tooltip",data.tooltip_stopped),angular.element(document.getElementById("account")).find(".account-status-icon").attr("data-tooltip",data.tooltip_stopped)),angular.element(document.getElementById("payment-card")).find(".confirm-payment").addClass("hidden"),angular.element(document.getElementById("payment-card")).find(".update-payment").removeClass("hidden"),angular.element(document.getElementById("button-confirm")).button("reset"),angular.element(document.getElementById("button-update")).button("reset"),vm.processingPayment=!1})}else{if(data.error){var alert='<div class="alert alert-danger"><i class="fa fa-exclamation-triangle"></i>'+data.error+"</div>";angular.element(document.getElementById("billing-notifications")).html(alert)}angular.element(document.getElementById("button-confirm")).button("reset"),angular.element(document.getElementById("button-update")).button("reset"),vm.processingPayment=!1}}function updatePaymentMethodResponse(data){data.success?angular.element(document.getElementById("billing-notifications")).html('<div class="alert alert-success"><i class="fa fa-check"></i>'+data.success+"</div>"):data.error&&angular.element(document.getElementById("billing-notifications")).html('<div class="alert alert-danger"><i class="fa fa-exclamation-triangle"></i>'+data.error+"</div>"),vm.processingPayment=!1,angular.element(document.getElementById("button-confirm")).button("reset"),angular.element(document.getElementById("button-update")).button("reset")}function updatePayment($event){angular.element(document.getElementById("payment-method-token")).val(angular.element($event.currentTarget).attr("data-value")).triggerHandler("change")}function cancelAccount(accountId){var post_data={account_id:accountId},button=angular.element(document.getElementById("button-cancel-account"));button.html(button.attr("data-loading")+"..."),button.attr("disabled","true"),$http.post("index.php?route=account/account/delete",post_data).success(function(data){data.redirect?window.location=data.redirect:data.success&&(button.html(button.attr("data-yes")),button.removeAttr("disabled"))})}function uncollapseBilling(){$rootScope.$broadcast("uncollapseBilling")}function collapse(){$rootScope.$broadcast("collapse")}var vm=this;vm.updateSpeed=updateSpeed,vm.updateBilling=updateBilling,vm.updateCart=updateCart,vm.updateOrderTotals=updateOrderTotals,vm.displayCoupon=displayCoupon,vm.applyCoupon=applyCoupon,window.paymentAttemptsFlag=0,vm.validatePayment=validatePayment,vm.validateform=validateform,vm.checkoutResponse=checkoutResponse,$scope.checkoutResponse=vm.checkoutResponse,vm.updatePaymentMethodResponse=updatePaymentMethodResponse,$scope.updatePaymentMethodResponse=vm.updatePaymentMethodResponse,vm.updatePayment=updatePayment,vm.cancelAccount=cancelAccount,vm.checkStatus=checkStatusService.checkStatus,vm.historyMarkup=timeAgoService.historyMarkup,vm.uncollapseBilling=uncollapseBilling,vm.collapse=collapse,vm.updateSpeedFlag=!1,vm.processingPayment=!1,vm.updatingCart=!1,$rootScope.$on("updateSpeed",function(e,$event){vm.updateSpeed($event)}),$rootScope.$on("updateBilling",function(e,$event){vm.updateBilling($event)})}angular.module("instag-app").controller("BillingTabController",BillingTabController),BillingTabController.$inject=["checkStatusService","timeAgoService","$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function ChartController(chartService,$http,$scope,$rootScope){function getChart(){$http.post("index.php?route=account/report_follower_growth",post_data).success(function(){data.redirect&&(window.location=data.redirect),data.success&&(vm.showChart(),vm.changeHeight())})}var vm=this;vm.getChart=getChart,vm.showChart=chartService.showChart,vm.changeHeight=chartService.changeHeight,$rootScope.$on("getChart",function(e){vm.getChart()})}angular.module("instag-app").controller("ChartController",ChartController),ChartController.$inject=["chartService","$http","$scope","$rootScope"]}(),function(){function DashboardTabController(chartService,$scope,$timeout,$http,$compile){function changeChart($event){var clickedElement=angular.element($event.currentTarget),itemsContainer=angular.element(document.getElementById("chart-carousel")).find(".carousel-inner"),activeElement=itemsContainer.find(".active");if(!slidingFlag){if(slidingFlag=!0,"next"==clickedElement.data("slide")){if(activeElement.index()<itemsContainer.length)var next=itemsContainer.children().eq(activeElement.index()+1);else var next=itemsContainer.children().eq(0);getChartData(next)}else{if(activeElement.index()>0)var next=itemsContainer.children().eq(activeElement.index()-1);else var next=itemsContainer.children().eq(itemsContainer.length);getChartData(next)}setTimeout(function(){slidingFlag=!1},600)}$(".carousel").carousel({pause:!0,interval:!1})}function changeHeight(){chartService.changeHeight()}function showChart(){chartService.showChart()}var vm=this;vm.changeChart=changeChart,vm.changeHeight=changeHeight,vm.showChart=showChart;var slidingFlag}angular.module("instag-app").controller("DashboardTabController",DashboardTabController),DashboardTabController.$inject=["chartService","$scope","$timeout","$http","$compile"]}(),function(){function HeaderController($scope,$timeout,$http,$compile,$rootScope){function openMenu(mobile){var mobile=mobile||!1,dropdown=angular.element(document.getElementById("tab-dropdown-middle"));(window.innerWidth>730||mobile)&&(dropdown.find("ul").hasClass("displayed")?(dropdown.find("ul").removeClass("displayed"),dropdown.find("ul").addClass("hide")):(dropdown.find("ul").addClass("displayed"),dropdown.find("ul").removeClass("hide")))}function closeMenu(){var dropdown=angular.element(document.getElementById("tab-dropdown-middle"));dropdown.find("ul").hasClass("displayed")&&(dropdown.find("ul").removeClass("displayed"),dropdown.find("ul").addClass("hide"))}function openLeftSidebar(notMobile){var notMobile=notMobile||!1,leftSidebar=angular.element(document.getElementById("left-sidebar"));leftSidebar.hasClass("open-sidebar")?leftSidebar.removeClass("open-sidebar"):notMobile&&window.innerWidth<=1570&&window.innerWidth>1200?window.innerWidth<=1570&&leftSidebar.addClass("open-sidebar"):!notMobile&&window.innerWidth<=1200&&(leftSidebar.addClass("open-sidebar"),angular.element(document.getElementById("close-sidebar")).addClass("opened-close-sidebar"))}function closeLeftSidebar(){$rootScope.$broadcast("closeLeftSidebar")}var vm=this;vm.openMenu=openMenu,vm.closeMenu=closeMenu,vm.openLeftSidebar=openLeftSidebar,vm.closeLeftSidebar=closeLeftSidebar}angular.module("instag-app").controller("HeaderController",HeaderController),HeaderController.$inject=["$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function KickoffController(checkStatusService,timeAgoService,$scope,$http,$compile,$timeout,$rootScope){function startKickoff(accountId){var startKickoffButton=angular.element(document.getElementById("start-kickoff-button"));if(startKickoffButton.hasClass("disabled-users")){var tabBtn={currentTarget:angular.element(document.getElementById("tab-header-middle")).find(".users")};vm.changeTab(tabBtn,"middle")}else if(startKickoffButton.hasClass("disabled-whitelist")){var tabBtn={currentTarget:angular.element(document.getElementById("tab-header-middle")).find(".whitelist")};vm.changeTab(tabBtn,"middle")}else angular.element(document.getElementById("loader")).addClass("loading"),startKickoffButton.addClass("loading-button"),$http.get("index.php?route=account/account/start&account_id="+accountId).success(function(data){data.redirect&&(window.location=data.redirect),data.success&&$timeout(function(){angular.element(document.getElementById("left-sidebar")).find(".current-account").trigger("click"),vm.checkStatus(angular.element(document.getElementById("content")).attr("data-msg"))},0)})}function skipWhitelist(accountId){var post_data={account_id:accountId};$http.post("index.php?route=account/account/skip_whitelist",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var skipWhitelistButton=angular.element(document.getElementById("skip-whitelist-card")).find(".gold-button"),listContainer=angular.element(document.getElementById("whitelist-users-list"));console.log("here"),console.log(skipWhitelistButton),skipWhitelistButton.attr("disabled","true"),
skipWhitelistButton.html(skipWhitelistButton.attr("data-language")),angular.element(document.getElementById("start-kickoff-button")).attr("data-skip-whitelist","1"),vm.checkUsersList(listContainer),angular.element(document.getElementById("skip-whitelist-warning")).removeClass("displayed")}})}function responsive(width){$rootScope.$broadcast("responsive",width)}function changeTab(event,tabGroup){$rootScope.$broadcast("changeTab",event,tabGroup)}function checkUsersList(listcontainer){$rootScope.$broadcast("checkUsersList",listcontainer)}var vm=this;vm.startKickoff=startKickoff,vm.skipWhitelist=skipWhitelist,vm.checkStatus=checkStatusService.checkStatus,vm.timeAgo=timeAgoService.timeAgo,vm.responsive=responsive,vm.changeTab=changeTab,vm.checkUsersList=checkUsersList}angular.module("instag-app").controller("KickoffController",KickoffController),KickoffController.$inject=["checkStatusService","timeAgoService","$scope","$http","$compile","$timeout","$rootScope"]}(),function(){function LeftSidebarController(checkStatusService,timeAgoService,chartService,$scope,$timeout,$http,$compile,$rootScope){function searchAccounts(searchQuery){var accountsContainer=angular.element(document.getElementById("dashboard-container")).find(".instagram-accounts");if(searchQuery.length)for(var accounts=accountsContainer.find(".account-item"),i=0;i<accounts.length;i++){var accountName=angular.element(accounts[i]).find(".sidebar-item-title span").attr("data-username");accountName.indexOf(searchQuery)<0?angular.element(accounts[i]).addClass("hide"):angular.element(accounts[i]).removeClass("hide")}else accountsContainer.find(".hide").removeClass("hide")}function setCurrent($event,callback){"object"==typeof braintree_integration&&braintree_integration.teardown(function(){braintree_integration=!1});var clickedElement=angular.element($event.currentTarget);if(!clickedElement.find(".account-square-status").hasClass("loading")){angular.element(document.getElementById("loader")).addClass("loading");var accountId=clickedElement.attr("data-id");try{localStorage.setItem("account_id",accountId)}catch(error){}$http.get("index.php?route=account/instagram/account&account_id="+accountId).success(function(data){data.redirect&&(window.location=data.redirect);angular.element(document.getElementById("main-container"));angular.element(document.getElementById("main-container")).contents().remove(),angular.element(document.getElementById("main-container")).html(data),$compile(angular.element(document.getElementById("main-container")).contents())($scope),angular.element(document.getElementById("content")).attr("data-kickoff")||($rootScope.$$listeners.changeSettings.length>0&&$rootScope.$$listeners.changeSettings.splice(1),$rootScope.$$listeners.getSources.length>0&&$rootScope.$$listeners.getSources.splice(1),$rootScope.$$listeners.updateBilling.length>0&&$rootScope.$$listeners.updateBilling.splice(1),$rootScope.$$listeners.updateSpeed.length>0&&$rootScope.$$listeners.updateSpeed.splice(1));var username=angular.element(document.getElementById("sidebar-username")).clone();if(angular.element(document.getElementById("header-username")).remove(),username.attr("id","header-username"),angular.element(document.getElementById("header")).append(username),!angular.element(document.getElementById("content")).attr("data-kickoff")){var post_data={account_id:accountId};$http.post("index.php?route=account/report_follower_growth",post_data).success(function(data){data&&(angular.element(document.getElementById("chart-card")).find(".card-content").empty().append($compile(data)($scope)),vm.showChart(),vm.changeHeight())})}for(var history=angular.element(document.getElementById("history-content")),time="",i=0;i<history.find(".history-item .item-content small").length;i++){var added=new Date(history.children().eq(i).find(".item-content small").attr("data-time")),offset=angular.element(document.getElementById("history-content")).attr("data-offset");time=vm.timeAgo(added,offset),history.find(".history-item .item-content small").eq(i).html(time)}if(clickedElement.parent().find(".current-account").removeClass("current-account"),clickedElement.addClass("current-account"),vm.responsive(window.innerWidth),clickedElement.hasClass("new-account")){clickedElement.removeClass("new-account");var image=angular.element(document.getElementById("profile-pic")).find("img").clone();clickedElement.find(".account-img").append(image)}vm.getSources(accountId),vm.checkStatus(angular.element(document.getElementById("content")).attr("data-msg")),angular.element(document.getElementById("follow-range")).find(".input-range").trigger("change"),angular.element(document.getElementById("unfollow-range")).find(".input-range").trigger("change");window.billingFlag=!1,angular.element(document.getElementById("loader")).removeClass("loading")})}}function changeAccountStatus($event,accountId){angular.element(document.getElementById("loader")).addClass("loading");for(var clickedElement=angular.element($event.currentTarget),accounts=angular.element(document.getElementById("left-sidebar")).find(".account-item"),removeClasses="reconnect kickoff stopped started start stop disabled expired loading",i=0;i<accounts.length;i++)if(accounts.eq(i).attr("data-id")==accountId)var accountElement=accounts.eq(i);if(accountElement&&!clickedElement.parent().attr("data-false")){var action=accountElement.find(".account-square-status").attr("data-action");if("started"==action)var endpoint="stop";else if("stopped"==action||"disabled"==action||"start"==action)var endpoint="start";if("reconnect"==clickedElement.attr("data-action"))vm.checkStatus("invalid_token"),angular.element(document.getElementById("loader")).removeClass("loading");else if("expired"==clickedElement.attr("data-action"))vm.checkStatus("expired"),angular.element(document.getElementById("loader")).removeClass("loading");else{if(accountElement.hasClass("current-account")){var buttonAccount=angular.element(document.getElementById("change-status-btn"));buttonAccount.addClass("loading")}accountElement.find(".account-square-status").removeClass(removeClasses).addClass("loading"),$http.get("index.php?route=account/account/"+endpoint+"&account_id="+accountId).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var squareStatus=accountElement.find(".account-square-status"),dotStatus=accountElement.find(".account-status");if("start"==endpoint?(accountElement.hasClass("current-account")&&(buttonAccount.removeClass(removeClasses).addClass("started").html("Stop").attr("data-action","stop"),buttonAccount.parent().find("i").removeClass("fa-stopped").addClass("fa-started"),buttonAccount.parent().find(".item-content p").html("Started")),squareStatus.removeClass(removeClasses).addClass("started").attr("data-action","started"),dotStatus.removeClass(removeClasses).addClass("started"),window.innerWidth<1200&&angular.element(document.getElementById("logo-u-container")).find(".account-item .account-status").removeClass(removeClasses).addClass("started")):"stop"==endpoint&&(accountElement.hasClass("current-account")&&(buttonAccount.removeClass(removeClasses).addClass("stopped").html("Start").attr("data-action","start"),buttonAccount.parent().find("i").removeClass("fa-started fa-stopped").addClass("fa-stopped"),buttonAccount.parent().find(".item-content p").html("Stopped")),squareStatus.removeClass(removeClasses).addClass("stopped").attr("data-action","stopped"),dotStatus.removeClass(removeClasses).addClass("stopped"),window.innerWidth<1200&&angular.element(document.getElementById("logo-u-container")).find(".account-item .account-status").removeClass(removeClasses).addClass("stopped")),data.tooltip?(accountElement.find(".account-square-status").attr("data-tooltip",data.tooltip),angular.element(document.getElementById("account")).find(".account-status .account-status-icon").attr("data-tooltip",data.tooltip)):(accountElement.find(".account-square-status").attr("data-tooltip",""),angular.element(document.getElementById("account")).find(".account-status .account-status-icon").attr("data-tooltip","")),accountElement.hasClass("current-account")){var historyContent=angular.element(document.getElementById("history-content"));if(data.$event){var item=vm.historyMarkup(data.$event,!0);historyContent.prepend(item)}}}if(data.event){var offset=angular.element(document.getElementById("history-content")).attr("data-offset"),date=new Date(data.event.date_added),html='<div class="sidebar-item history-item">';html+='<i class="fa fa-event-'+data.event.code+' history-icon"></i>',html+='<div class="item-content">',html+="<h4>"+data.event.title+"</h4>",html+="<p>"+data.event.description+"</p>",html+='<small data-time="'+data.event.date_added+'">'+vm.timeAgo(date,offset)+"</small>",angular.element(document.getElementById("history-content")).prepend(html)}angular.element(document.getElementById("loader")).removeClass("loading")})}}}function addAccountModal(){angular.element(document.getElementById("modal-add-instagram")).addClass("displayed"),angular.element(window).innerWidth()<1200&&vm.closeLeftSidebar()}function closeLeftSidebar(notMobile){var notMobile=notMobile||!1;notMobile&&window.innerWidth<=1570&&window.innerWidth>1200?(angular.element(document.getElementById("left-sidebar")).removeClass("open-sidebar"),window.innerWidth<=1200&&angular.element(document.getElementById("close-sidebar")).removeClass("opened-close-sidebar")):notMobile||(angular.element(document.getElementById("left-sidebar")).removeClass("open-sidebar"),window.innerWidth<=1200&&angular.element(document.getElementById("close-sidebar")).removeClass("opened-close-sidebar"))}function logoHover(){window.innerWidth<=1570&&window.innerWidth>730&&angular.element(document.getElementById("logo")).addClass("hover")}function removeLogoHover(){window.innerWidth<=1570&&(angular.element(document.getElementById("logo")).removeClass("hover"),vm.closeLeftSidebar())}function updateFeed($event){$rootScope.$broadcast("updateFeed",$event)}function responsive(width){$rootScope.$broadcast("responsive",width)}function getChart(){$rootScope.$broadcast("getChart")}function getSources(accountId){$rootScope.$broadcast("getSources",accountId)}var vm=this;vm.searchAccounts=searchAccounts,vm.setCurrent=setCurrent,vm.changeAccountStatus=changeAccountStatus,vm.addAccountModal=addAccountModal,vm.closeLeftSidebar=closeLeftSidebar,vm.logoHover=logoHover,vm.removeLogoHover=removeLogoHover,vm.checkStatus=checkStatusService.checkStatus,vm.timeAgo=timeAgoService.timeAgo,vm.historyMarkup=timeAgoService.historyMarkup,vm.showChart=chartService.showChart,vm.changeHeight=chartService.changeHeight,vm.updateFeed=updateFeed,vm.responsive=responsive,vm.getChart=getChart,vm.getSources=getSources,$rootScope.$on("changeAccountStatus",function(e,$event,accountId){vm.changeAccountStatus($event,accountId)}),$rootScope.$on("closeLeftSidebar",function(){vm.closeLeftSidebar()})}angular.module("instag-app").controller("LeftSidebarController",LeftSidebarController),LeftSidebarController.$inject=["checkStatusService","timeAgoService","chartService","$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function LoadController($timeout,$scope,$compile,$window,$rootScope){function scopeLoad(){vm.responsive(window.innerWidth),"undefined"!=localStorage&&void 0!=localStorage&&"undefined"!=localStorage.account_id&&void 0!=localStorage.account_id?$timeout(function(){for(var accounts=angular.element(document.getElementById("left-sidebar")).find(".account-item"),clickedFlag=!1,i=0;i<accounts.length;i++)accounts.eq(i).attr("data-id")==localStorage.account_id&&(accounts.eq(i).trigger("click"),clickedFlag=!0);clickedFlag||$timeout(function(){angular.element(document.getElementById("left-sidebar")).find(".account-item").eq(0).trigger("click")},0)},0):$timeout(function(){angular.element(document.getElementById("left-sidebar")).find(".account-item").eq(0).trigger("click")},0),vm.listenKeys(),angular.element(document.getElementById("loader")).css("display","none")}function listenKeys(){function keyDownTextField(e){var keyCode=e.keyCode;switch(keyCode){case 27:angular.element(document).find(".search-box-displayed").removeClass("search-box-displayed")}}document.addEventListener("keydown",keyDownTextField,!1)}function responsive(width){$rootScope.$broadcast("responsive",width)}var vm=this;vm.responsive=responsive,vm.listenKeys=listenKeys,$scope.load=scopeLoad,angular.element($window).bind("resize",function(){vm.responsive(window.innerWidth)})}angular.module("instag-app").controller("LoadController",LoadController),LoadController.$inject=["$timeout","$scope","$compile","$window","$rootScope"]}(),function(){function LocationsController($scope,$timeout,$http,$compile,$rootScope){}angular.module("instag-app").controller("LocationsController",LocationsController),LocationsController.$inject=["$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function ModalsController(modalsService,timeAgoService,$scope,$timeout,$http,$compile,$rootScope){function closeModal($event){var $event=$event||!1;if($event){var clickedElement=angular.element($event.target);angular.element($event.target).hasClass("modal")&&(clickedElement.removeClass("displayed"),"video-modal"==$event.target.id&&$timeout(function(){angular.element(document.getElementById("stop-video")).trigger("click")}),vm.triggerHideTooltip())}else angular.element(document.getElementById("dashboard")).find(".modal.displayed").removeClass("displayed")}function addAccount(){var username=angular.element(document.getElementById("add-account-username")).val();if(""==username)$timeout(function(){angular.element(document.getElementById("username-empty")).trigger("click")},0);else{var password=angular.element(document.getElementById("add-account-password")).val();if(""==password)$timeout(function(){angular.element(document.getElementById("password-empty")).trigger("click")},0);else{vm.triggerHideTooltip();var clickedElement=angular.element(document.getElementById("button-add-instagram"));clickedElement.addClass("loading-button").attr("disabled","true");var post_data={username:username,password:password};$http.post("index.php?route=account/instagram/insert",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var newAccount=angular.element(document.getElementById("left-sidebar")).find(".instagram-accounts .current-account").clone();newAccount.removeClass("hide"),newAccount.attr("ng-click","leftSidebar.setCurrent($event)"),newAccount.attr("data-false","true"),newAccount.attr("data-id",data.account_id).removeClass("current-account").addClass("new-account"),newAccount.find(".account-img .account-status").removeClass("started reconnect").addClass("kickoff"),newAccount.find(".account-img img").remove(),newAccount.find(".account-img").append('<img src="'+data.profile_picture+'">'),username.length>14&&(username=username.substring(0,14)+"..."),newAccount.find(".sidebar-item-title span").attr("data-username",username).html(username+"<br /><small>Account</small>"),newAccount.find(".account-square-status").attr("id",data.account_id).attr("data-action","kickoff").attr("data-tooltip",data.kickoff_tooltip),newAccount.find(".account-square-status").removeClass("started reconnect").addClass("kickoff"),newAccount.find(".account-square-status").attr("ng-click",'leftSidebar.changeAccountStatus("'+data.account_id+'",$event)'),newAccount.removeClass("hide");var accountsContainer=angular.element(document.getElementById("left-sidebar")).find(".instagram-accounts"),scope=accountsContainer.scope();accountsContainer.append($compile(newAccount)(scope)),angular.element(document.getElementById("modal-add-instagram")).removeClass("displayed"),$timeout(function(){newAccount.trigger("click")},0)}else{var errorContainer=angular.element(document.getElementById("add-instagram-error")),emulatedEvent={currentTarget:document.getElementById("add-instagram-error")};data.errors.warning?errorContainer.attr("data-tooltip",data.errors.warning):data.errors.exists?errorContainer.attr("data-tooltip",data.errors.exists):errorContainer.attr("data-tooltip",data.errors),vm.displayTooltip(emulatedEvent)}clickedElement.removeAttr("disabled"),angular.element(document.getElementById("button-add-instagram")).removeClass("loading-button")})}}}function reconnectAccount($event,accountId){var clickedElement=angular.element($event.currentTarget);clickedElement.attr("disabled","true");var modal=angular.element(document.getElementById("reconnect-modal")),username=modal.find("#instagram_username").val();if(""==username)$timeout(function(){modal.find(".username-tooltip").trigger("click")},0);else{var password=modal.find("#instagram_password").val();if(""==password)$timeout(function(){modal.find(".password-tooltip").trigger("click")},0);else{angular.element(document.getElementById("button-reconnect")).addClass("loading-button");var post_data={username:username,password:password};$http.post("index.php?route=account/instagram/reconnect&account_id="+accountId,post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var currentAccount=angular.element(document.getElementById("left-sidebar")).find(".current-account");currentAccount.removeAttr("data-false"),currentAccount.find(".account-status").removeClass("reconnect").addClass("stopped"),currentAccount.find(".account-square-status").removeClass("reconnect").addClass("stopped");var accountStatus=angular.element(document.getElementById("account")).find(".run-status"),rightSidebarButton=angular.element(document.getElementById("change-status-btn"));accountStatus.find("i").removeClass("fa-chain-broken fa-reconnect").addClass("fa-stopped"),accountStatus.find(".item-content p").html("Stopped"),rightSidebarButton.removeClass("reconnect-button").addClass("stopped").attr("data-action","start").html("Start"),data.tooltip?(currentAccount.find(".account-square-status").attr("data-tooltip",data.tooltip),angular.element(document.getElementById("account")).find(".account-status .account-status-icon").attr("data-tooltip",data.tooltip)):(currentAccount.find(".account-square-status").attr("data-tooltip",""),angular.element(document.getElementById("account")).find(".account-status .account-status-icon").attr("data-tooltip")),angular.element(document.getElementById("button-reconnect")).removeClass("loading-button"),angular.element(document.getElementById("content")).attr("data-msg","");var historyContent=angular.element(document.getElementById("history-content"));if(data.event){var item=vm.historyMarkup(data.event,!0);historyContent.prepend(item)}modal.removeClass("displayed"),angular.element(document.getElementById("right-sidebar")).css("z-index","4"),angular.element(document.getElementById("reconnect-modal")).css("z-index","4"),vm.changeAccountStatus(event,accountId)}else data.errors&&(data.errors.warning?(modal.find(".username-tooltip").attr("data-tooltip",data.errors.warning),$timeout(function(){modal.find(".username-tooltip").trigger("click")},0),angular.element(document.getElementById("button-reconnect")).removeClass("loading-button")):(modal.find(".username-tooltip").attr("data-tooltip",data.errors),$timeout(function(){modal.find(".username-tooltip").trigger("click")},0),angular.element(document.getElementById("button-reconnect")).removeClass("loading-button")));clickedElement.removeAttr("disabled")})}}}function helpModal($event){if(angular.element(window).innerWidth()>980){var videoContainer=angular.element(document.getElementById("help-video"));videoContainer.parent().find("#video-loader").addClass("displayed"),videoContainer.css("opacity","0");var videoId=angular.element($event.currentTarget).attr("data-video-id"),videoSrc="https://www.youtube.com/embed/"+videoId+"?rel=0&amp;controls=0&amp;showinfo=0";vm.videoModal(),videoContainer.attr("src")!=videoSrc+"&enablejsapi=1"?(videoContainer.attr("src",videoSrc+"&enablejsapi=1"),videoContainer.load(function(){videoContainer.parent().find("#video-loader").removeClass("displayed"),videoContainer.css("opacity","1"),$timeout(function(){videoContainer.parent().find("#help-video-button").trigger("click")},0)})):(videoContainer.parent().find("#video-loader").removeClass("displayed"),videoContainer.css("opacity","1"),$timeout(function(){videoContainer.parent().find("#help-video-button").trigger("click")},0))}else{var videoId=angular.element($event.currentTarget).attr("data-video-id"),videoSrc="https://www.youtube.com/embed/"+videoId;window.open(videoSrc,"_blank")}}function videoModal(close){var close=close||!1;angular.element(document.getElementById("video-modal")).addClass("displayed"),vm.closeLeftSidebar(),close&&angular.element(document.getElementById("video-modal")).removeClass("displayed")}function cancelAction(container){angular.element(document.getElementById(container)).removeClass("displayed")}function topSourcesWarning(container,sourceId,sourceType){var warningElement=angular.element(document.getElementById(container));warningElement.find(".confirm").attr("data-source",sourceId).attr("data-type",sourceType),warningElement.addClass("displayed")}function changeAccountStatus(event,accountId){$rootScope.$broadcast("changeAccountStatus",event,accountId)}function displayTooltip($event){$rootScope.$broadcast("displayTooltip",$event)}function hideTooltip($event){$rootScope.$broadcast("hideTooltip",$event)}function triggerHideTooltip(){$rootScope.$broadcast("triggerHideTooltip")}function closeLeftSidebar(){$rootScope.$broadcast("closeLeftSidebar")}var vm=this;vm.closeModal=closeModal,vm.addAccount=addAccount,vm.reconnectAccount=reconnectAccount,vm.helpModal=helpModal,vm.videoModal=videoModal,vm.cancelAction=cancelAction,vm.topSourcesWarning=topSourcesWarning,vm.displayWarning=modalsService.displayWarning,vm.historyMarkup=timeAgoService.historyMarkup,vm.changeAccountStatus=changeAccountStatus,vm.displayTooltip=displayTooltip,vm.hideTooltip=hideTooltip,vm.triggerHideTooltip=triggerHideTooltip,vm.closeLeftSidebar=closeLeftSidebar,$rootScope.$on("closeModal",function(e,$event){vm.closeModal($event)})}angular.module("instag-app").controller("ModalsController",ModalsController),ModalsController.$inject=["modalsService","timeAgoService","$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function RemoveController($http,$timeout,$compile,$scope,$rootScope){function removeSource(accountId,list,source){angular.element(document.getElementById("loader")).addClass("loading");var post_data={account_id:accountId,list:list,data:[source]};window.searchRemoveFlag?window.searchRemoveFlag=!1:angular.element(document.getElementById("dashboard-container")).find(".search-box-displayed").removeClass("search-box-displayed"),$http.post("index.php?route=account/setting/remove_from_list",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){switch(list){case"follow_source_users":var usersCount=parseInt(angular.element(document.getElementById("users-notification-count")).html()),listContainer=angular.element(document.getElementById("user-sources-list"));usersCount--,angular.element(document.getElementById("users-notification-count")).html(usersCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".users .notification-count").html(usersCount);break;case"follow_source_tags":var tagsCount=parseInt(angular.element(document.getElementById("tags-notification-count")).html()),listContainer=angular.element(document.getElementById("hashtag-sources-list"));tagsCount--,angular.element(document.getElementById("tags-notification-count")).html(tagsCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".hashtags .notification-count").html(tagsCount);break;case"follow_source_locations":var locationsCount=parseInt(angular.element(document.getElementById("locations-notification-count")).html()),listContainer=angular.element(document.getElementById("locations-sources-list"));locationsCount--,angular.element(document.getElementById("locations-notification-count")).html(locationsCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".locations .notification-count").html(locationsCount);break;case"whitelist_users":var usersCount=parseInt(angular.element(document.getElementById("whitelist-notification-count")).html()),listContainer=angular.element(document.getElementById("whitelist-users-list"));usersCount--,angular.element(document.getElementById("whitelist-notification-count")).html(usersCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".whitelist .notification-count").html(usersCount)}listContainer.find("."+source).remove(),angular.element(document.getElementById("content")).attr("data-kickoff")?vm.checkUsersList(listContainer):"follow_source_locations"==list?vm.checkTopSourcesTable("l"+source):vm.checkTopSourcesTable(source)}angular.element(document.getElementById("loader")).removeClass("loading")})}function removeFromList($event,accountId,list,source){vm.removeSource(accountId,list,source)}function removeFromWarning($event,accountId){var clickedElement=angular.element($event.currentTarget);switch(clickedElement.attr("data-type")){case"user":var list="follow_source_users",source=clickedElement.attr("data-source");break;case"tag":var list="follow_source_tags",source=clickedElement.attr("data-source");break;case"location":var list="follow_source_locations",source=clickedElement.attr("data-source").substring(1)}list&&vm.removeSource(accountId,list,source),angular.element(document.getElementById("source-remove")).removeClass("displayed")}function removeFromSearch($event,accountId,list,source){$timeout(function(){window.searchRemoveFlag=!0;var clickedElement=angular.element($event.currentTarget);switch(list){case"follow_source_users":var button="<button ng-click=\"addUsers.addUsers($event,'"+accountId+"','"+list+'\')"><i class="fa fa-plus"></i></button>';break;case"follow_source_tags":var button="<button ng-click=\"addTags.addTags($event,'"+accountId+'\')"><i class="fa fa-plus"></i></button>';break;case"follow_source_locations":var button="<button ng-click=\"add.addLocation($event,'"+accountId+'\')"><i class="fa fa-plus"></i></button>';break;case"whitelist_users":var button="<button ng-click=\"addUsers.addUsers($event,'"+accountId+"','"+list+'\')"><i class="fa fa-plus"></i></button>'}vm.removeSource(accountId,list,source),clickedElement.parent().append($compile(button)($scope)),clickedElement.remove()},0)}function checkTopSourcesTable(sourceClass){angular.element(document.getElementById("sources-table")).find("."+sourceClass).removeClass("active-source")}function clearList(accountId,list,callback){var callback=callback||!1,post_data={list:list,account_id:accountId};$http.post("index.php?route=account/setting/clear_list",post_data).success(function(data){switch(data.redirect&&(window.location=data.redirect),list){case"follow_source_users":var listContainer=angular.element(document.getElementById("user-sources-list")),mobileCount=".users .notification-count",desktopCount="users-notification-count";break;case"follow_source_tags":var listContainer=angular.element(document.getElementById("hashtag-sources-list")),mobileCount=".hashtags .notification-count",desktopCount="tags-notification-count";break;case"follow_source_locations":var listContainer=angular.element(document.getElementById("locations-sources-list")),mobileCount=".locations .notification-count",desktopCount="locations-notification-count";break;case"whitelist_users":var listContainer=angular.element(document.getElementById("whitelist-users-list")),mobileCount=".whitelist .notification-count",desktopCount="whitelist-notification-count"}if("whitelist_users"!=list)for(var sourcesTable=angular.element(document.getElementById("sources-table")).find(".table-body"),i=0;i<sourcesTable.children().length;i++){var source=sourcesTable.children().eq(i).find(".users-column");"location"==source.attr("data-type")?sourceClass="."+source.attr("data-source").substring(1):sourceClass="."+source.attr("data-source"),listContainer.find(sourceClass).length&&source.removeClass("active-source")}listContainer.empty(),angular.element(document.getElementById("tab-dropdown-middle")).find(mobileCount).html("0"),angular.element(document.getElementById(desktopCount)).html("0"),angular.element(document.getElementById("dashboard")).find(".warning-modal").removeClass("displayed"),callback&&callback(accountId)})}function checkUsersList(listContainer){$rootScope.$broadcast("checkUsersList",listContainer)}var vm=this;vm.removeSource=removeSource,vm.removeFromList=removeFromList,vm.removeFromWarning=removeFromWarning,vm.removeFromSearch=removeFromSearch,window.searchRemoveFlag=!1,vm.checkTopSourcesTable=checkTopSourcesTable,vm.clearList=clearList,vm.checkUsersList=checkUsersList,$rootScope.$on("clearList",function(e,accountId,list,callback){vm.clearList(accountId,list,callback)})}angular.module("instag-app").controller("RemoveController",RemoveController),RemoveController.$inject=["$http","$timeout","$compile","$scope","$rootScope"]}(),function(){function ResizeController(chartService,$scope,$compile,$timeout,$rootScope){function responsive(width){var width=width||window.innerWidth();"dashboard"==angular.element("tab-header-middle").find(".current-tab").attr("data-tab")&&vm.changeHeight();var tabHeader=angular.element(document.getElementById("tab-header-middle")),leftSidebar=angular.element(document.getElementById("left-sidebar")),rightSidebar=angular.element(document.getElementById("right-sidebar")),availableSpace=angular.element(window).innerWidth()-(leftSidebar.innerWidth()+rightSidebar.innerWidth());if(!window.tabHeaderWidth&&angular.element(window).innerWidth()>1200||window.tabHeaderWidth<=40){window.tabHeaderWidth=0;for(var i=0;i<tabHeader.children().length;i++)window.tabHeaderWidth+=tabHeader.children().eq(i).outerWidth(!0);window.tabHeaderWidth+=40}if(window.tabHeaderWidth&&(window.tabHeaderWidth>=availableSpace?angular.element(document.getElementById("content")).hasClass("overwidth")||angular.element(document.getElementById("content")).addClass("overwidth"):angular.element(document.getElementById("content")).hasClass("overwidth")&&angular.element(document.getElementById("content")).removeClass("overwidth")),width<1200){angular.element(document.getElementById("logo-u-container")).find(".account-item").remove();var currentAccount=angular.element(document.getElementById("left-sidebar")).find(".current-account").clone();currentAccount.removeAttr("ng-click"),currentAccount.find(".account-square-status").removeAttr("ng-click"),currentAccount.find(".sidebar-item-title").remove(),angular.element(document.getElementById("logo-u-container")).append($compile(currentAccount)($scope)),currentAccount.find(".account-img img").length<1?(angular.element(document.getElementById("logo-u")).addClass("displayed"),angular.element(document.getElementById("logo-u-container")).find(".account-status").remove()):angular.element(document.getElementById("logo-u")).removeClass("displayed"),vm.closeLeftSidebar(),$timeout(function(){var content=angular.element(document.getElementById("content")),currentTab=content.find(".tab-header .current-tab").attr("data-tab");content.find(".dropdown-menu ."+currentTab).triggerHandler("click")},0),mobileResponsive(width)}else angular.element(document.getElementById("logo-u-container")).find(".account-item").remove(),mobileResponsive(width);var windowHeight=angular.element(window).innerHeight(),leftSidebar=angular.element(document.getElementById("left-sidebar")),instaAccounts=leftSidebar.find(".instagram-accounts"),addInstaBtn=leftSidebar.find("#add-account"),bottomLeftSidebar=leftSidebar.find("#bottom-left-sidebar");if(!vm.instaAccountsHeight){vm.instaAccountsHeight=0;for(var i=0;i<=instaAccounts.children().length;i++)vm.instaAccountsHeight+=instaAccounts.children().eq(i).innerHeight()}windowHeight<=vm.instaAccountsHeight+addInstaBtn.outerHeight()+bottomLeftSidebar.outerHeight()+70?(instaAccounts.hasClass("overflow")||instaAccounts.addClass("overflow"),
instaAccounts.css("maxHeight",windowHeight-(bottomLeftSidebar.outerHeight()+addInstaBtn.outerHeight()+70))):instaAccounts.hasClass("overflow")&&(instaAccounts.removeClass("overflow"),instaAccounts.css("maxHeight","none"))}function mobileResponsive(width){if(width<730){var content=angular.element(document.getElementById("content"));angular.element(document.getElementById("right-sidebar"));if(content.attr("data-kickoff")){if(0==content.find("#start-account").length){var tabContent=angular.element(document.getElementById("tab-body-sidebar")).html();content.find(".middle-tab").prepend($compile(tabContent)($scope)),content.find("#start-account").removeClass("current-account"),angular.element(document.getElementById("tab-body-sidebar")).empty()}vm.responsiveFlag=!1,$timeout(function(){var content=angular.element(document.getElementById("content")),currentTab=content.find(".tab-header .current-tab").attr("data-tab");"kickoff"==currentTab&&content.find(".dropdown-menu .start-account").triggerHandler("click")},0)}else{if(0==content.find("#account").length){var tabContent=angular.element(document.getElementById("tab-body-sidebar")).html();content.find(".middle-tab").prepend($compile(tabContent)($scope))}$timeout(function(){var content=angular.element(document.getElementById("content")),currentTab=content.find(".tab-header .current-tab").attr("data-tab");"dashboard"!=currentTab||vm.responsiveFlag||(vm.responsiveFlag=!0,content.find(".dropdown-menu .account").triggerHandler("click"))},0),window.graphic&&window.graphic.options.maintainAspectRatio&&(window.graphic.options.maintainAspectRatio=!1,window.graphic.update())}}else if(width>730){angular.element(document.getElementById("tab-dropdown-middle")).removeClass("hide");var content=angular.element(document.getElementById("content"));content.attr("data-kickoff")?$timeout(function(){var content=angular.element(document.getElementById("content")),currentTab=content.find(".tab-header .current-tab").attr("data-tab");"start-account"!=currentTab&&void 0!=currentTab?content.find(".dropdown-menu ."+currentTab).triggerHandler("click"):content.find(".dropdown-menu .kickoff").triggerHandler("click");var startAccountTab=content.find("#start-account");startAccountTab.addClass("current-tab");var sidebarTabBody=angular.element(document.getElementById("tab-body-sidebar"));sidebarTabBody.append($compile(startAccountTab)($scope)),$scope.$digest()},0):($timeout(function(){var content=angular.element(document.getElementById("content")),currentTab=content.find(".tab-header .current-tab").attr("data-tab");"account"!=currentTab&&"activity"!=currentTab&&void 0!=currentTab?content.find(".dropdown-menu ."+currentTab).triggerHandler("click"):content.find(".dropdown-menu .dashboard").triggerHandler("click");var rightSidebar=angular.element(document.getElementById("tab-body-sidebar"));rightSidebar.append(content.find("#account")),$compile(rightSidebar.contents())($scope),rightSidebar.append(content.find("#activity")),$compile(rightSidebar.contents())($scope)},0),window.graphic&&window.graphic.options.maintainAspectRatio&&(window.graphic.options.maintainAspectRatio=!1,window.graphic.update()))}}function closeLeftSidebar($event){$rootScope.$broadcast("closeLeftSidebar",$event)}var vm=this;vm.responsiveFlag=!1,vm.responsive=responsive,vm.mobileResponsive=mobileResponsive,vm.changeHeight=chartService.changeHeight,vm.closeLeftSidebar=closeLeftSidebar,$rootScope.$on("responsive",function(e,width){vm.responsive(width)})}angular.module("instag-app").controller("ResizeController",ResizeController),ResizeController.$inject=["chartService","$scope","$compile","$timeout","$rootScope"]}(),function(){function RightSidebarController(timeAgoService,$scope,$http,$timeout,$rootScope){function changeFlow(button,accountId){if(!window.changingFlow){window.changingFlow=!0,angular.element(document.getElementById("loader")).addClass("loading");var followBtn=angular.element(document.getElementById("follow-button")),unFollowBtn=angular.element(document.getElementById("unfollow-button")),flow=button;"follow"==button?followBtn.hasClass("active")?(flow="unfollow",followBtn.removeClass("active").addClass("inactive"),unFollowBtn.removeClass("inactive").addClass("active")):(followBtn.removeClass("inactive").addClass("active"),unFollowBtn.removeClass("active").addClass("inactive")):unFollowBtn.hasClass("active")?(flow="follow",unFollowBtn.removeClass("active").addClass("inactive"),followBtn.removeClass("inactive").addClass("active")):(unFollowBtn.removeClass("inactive").addClass("active"),followBtn.removeClass("active").addClass("inactive")),$http.get("index.php?route=account/account/flow&account_id="+accountId+"&flow="+flow).success(function(data){data.redirect&&(window.location=data.redirect);var historyContent=angular.element(document.getElementById("history-content")),item=vm.historyMarkup(data.event,!0);historyContent.prepend(item),window.changingFlow=!1,angular.element(document.getElementById("loader")).removeClass("loading")})}}function accountStatus($event,accountId){$event.bubbles&&($event.bubbles=!1,$rootScope.$broadcast("changeAccountStatus",$event,accountId))}function changeSettings($event,endpoint,id){$event.bubbles&&($event.bubbles=!1,$rootScope.$broadcast("changeSettings",$event,endpoint,id))}var vm=this;vm.changeFlow=changeFlow,window.changingFlow=!1,vm.historyMarkup=timeAgoService.historyMarkup,vm.accountStatus=accountStatus,vm.changeSettings=changeSettings}angular.module("instag-app").controller("RightSidebarController",RightSidebarController),RightSidebarController.$inject=["timeAgoService","$scope","$http","$timeout","$rootScope"]}(),function(){function SearchController($http,$scope,$timeout,$compile){function searchInstagram(searchInput,parentId,accountId){var searchElementContainer=angular.element(document.getElementById(parentId));searchInput.length>2?(clearTimeout(timeOut),timeOut=setTimeout(function(){var currentSearchValue=searchElementContainer.find(".input-search input").val();if(currentSearchValue.length){searchElementContainer.find(".search-results").addClass("search-box-displayed").empty().append('<img class="loading-gif" src="catalog/view/theme/default/image/dashboard/loading.gif" />'),document.getElementById("dashboard-container").addEventListener("click",closeSearchDropdown);var results="";if("search-whitelist"==parentId)var addEndpoint="whitelist_users",list=angular.element(document.getElementById("whitelist-users-list"));else var addEndpoint="follow_source_users",list=angular.element(document.getElementById("user-sources-list"));currentSearchValue+="&account_id="+accountId,$http.get("index.php?route=account/instagram/search_users&username="+currentSearchValue).success(function(data){if(data.redirect&&(window.location=data.redirect),data.users){window.innerWidth<760?charLimit=19:charLimit=24;for(var i=0;i<data.users.length;i++)results+='<div class="user-search-result" ng-controller="AddSourcesController as addUsers">',results+='<img src="'+data.users[i].profile_picture+'" />',results+='<div class="user-id" id="'+data.users[i].id+'">',results+=data.users[i].username.length<=charLimit?'<h4 data-username="'+data.users[i].username+'">'+data.users[i].username+"</h4>":'<h4 data-username="'+data.users[i].username+'">'+data.users[i].username.substr(0,charLimit)+"...</h4>",results+="<p>"+data.users[i].full_name+"</p>",results+="</div>",list.find("."+data.users[i].username.replace(".","")).length?(results+='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','"+addEndpoint+"','"+data.users[i].id+'\')" class="repeated-user">',results+='<i class="fa fa-check"></i>',results+="</button>"):results+="<button ng-click=\"addUsers.addUsers($event,'"+accountId+"','"+addEndpoint+'\')"><i class="fa fa-plus"></i></button>',results+="</div>";searchElementContainer.find(".search-results").empty().append($compile(results)($scope))}else searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()})}else searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()},600)):searchInput.length<3&&searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()}function searchTags(searchInput,parentId,accountId){var searchElementContainer=angular.element(document.getElementById(parentId));searchInput.length>2?(clearTimeout(timeOut),timeOut=setTimeout(function(){var currentSearchValue=searchElementContainer.find(".input-search input").val().replace("#","");if(currentSearchValue){searchElementContainer.find(".search-results").addClass("search-box-displayed").empty().append('<img class="loading-gif" src="catalog/view/theme/default/image/dashboard/loading.gif" />'),document.getElementById("dashboard-container").addEventListener("click",closeSearchDropdown);var results="";currentSearchValue+="&account_id="+accountId,$http.get("index.php?route=account/instagram/search_tags&tag="+currentSearchValue).success(function(data){if(data.redirect&&(window.location=data.redirect),data.tags){window.innerWidth<760?charLimit=17:charLimit=24;for(var i=0;i<data.tags.length;i++){if(mediaCount=vm.numberWithCommas(data.tags[i].media_count),results+='<div class="user-search-result" ng-controller="AddSourcesController as addTags">',results+='<i class="fa fa-hashtag"></i>',results+='<div class="user-id" id="'+data.tags[i].name+'">',results+=data.tags[i].name.length<=charLimit?'<h4 data-tag="'+data.tags[i].name+'">'+data.tags[i].name+"</h4>":'<h4 data-tag="'+data.tags[i].name+'">'+data.tags[i].name.substr(0,charLimit)+"...</h4>",results+="<p>"+mediaCount+" posts</p>",results+="</div>",angular.element(document.getElementById("hashtag-sources-list")).find("."+data.tags[i].name.replace(".","")).length){var listItem=data.tags[i].name.replace(".","");results+='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','follow_source_tags','"+listItem+'\')" class="repeated-user">',results+='<i class="fa fa-check"></i>',results+="</button>"}else results+="<button ng-click=\"addTags.addTags($event,'"+accountId+'\')"><i class="fa fa-plus"></i></button>';results+="</div>"}searchElementContainer.find(".search-results").empty().append($compile(results)($scope))}else searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()})}else searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()},600)):searchInput.length<2&&searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()}function searchLocations(searchInput,parentId,accountId){var searchElementContainer=angular.element(document.getElementById(parentId));searchInput.length>2?(clearTimeout(timeOut),timeOut=setTimeout(function(){var currentSearchValue=searchElementContainer.find(".input-search input").val();if(currentSearchValue){searchElementContainer.find(".search-results").addClass("search-box-displayed").empty().append('<img class="loading-gif" src="catalog/view/theme/default/image/dashboard/loading.gif" />'),document.getElementById("dashboard-container").addEventListener("click",closeSearchDropdown);var results="",post_data={account_id:accountId,query:currentSearchValue};$http.post("index.php?route=account/instagram/search_locations",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.locations){window.innerWidth<760?charLimit=20:charLimit=30;for(var i=0;i<data.locations.length;i++){results+='<div class="user-search-result" ng-controller="AddSourcesController as add">',results+='<i class="fa fa-map-marker"></i>',results+='<div class="location-id" id="'+data.locations[i].id+'">',data.locations[i].name.length<=charLimit?(results+='<h4 data-location="'+data.locations[i].name+'" ',results+='data-subtitle="'+data.locations[i].subtitle+'">',results+=data.locations[i].name+"</h4>"):(results+='<h4 data-location="'+data.locations[i].name+'" ',results+='data-subtitle="'+data.locations[i].subtitle+'">',results+=data.locations[i].name.substr(0,charLimit)+"...</h4>"),results+="<p>"+data.locations[i].subtitle+"</p>",results+="</div>";var locationId=data.locations[i].id;angular.element(document.getElementById("locations-sources-list")).find("."+locationId).length?(results+='<button ng-controller="RemoveController as remove" ng-click="remove.removeFromSearch($event,\''+accountId+"','follow_source_locations','"+locationId+'\')" class="repeated-user">',results+='<i class="fa fa-check"></i>',results+="</button>"):results+="<button ng-click=\"add.addLocation($event,'"+accountId+'\')"><i class="fa fa-plus"></i></button>',results+="</div>"}searchElementContainer.find(".search-results").empty().append($compile(results)($scope))}else searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()})}else searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()},600)):searchInput.length<2&&searchElementContainer.find(".search-results").removeClass("search-box-displayed").empty()}function closeSearchDropdown(e){var searchBox=angular.element(document.getElementById("dashboard-container")).find(".search-box-displayed");searchBox.find(e.target).length||angular.element(e.target).hasClass("search-results")||angular.element(e.target).parent().hasClass("user-list")||(window.clickedTarget=e.target,searchBox.removeClass("search-box-displayed"),document.getElementById("dashboard-container").removeEventListener("click",closeSearchDropdown))}function numberWithCommas(x){var parts=x.toString().split(".");return parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),parts.join(".")}var timeOut,vm=this;vm.searchUsers=searchInstagram,vm.searchTags=searchTags,vm.searchLocations=searchLocations,vm.closeSearchDropdown=closeSearchDropdown,vm.numberWithCommas=numberWithCommas}angular.module("instag-app").controller("SearchController",SearchController),SearchController.$inject=["$http","$scope","$timeout","$compile"]}(),function(){function SettingsTabController($scope,$http,$timeout,$rootScope){function changeSettings($event,endpoint,id,speed){if($event)var clickedElement=angular.element($event.currentTarget);angular.element(document.getElementById("loader")).addClass("loading");var speed=speed||!1,cancelRequest=!1,post_data={account_id:id,data:{}};switch(endpoint){case"follow":clickedElement.parent().parent().find("button").html(clickedElement.html()+"<span class='caret'></span>"),post_data.data.follows_max_limit=clickedElement.html();break;case"unfollow-limit":clickedElement.parent().parent().find("button").html(clickedElement.html()+"<span class='caret'></span>"),clickedElement.parent().parent().find("button").attr("data-limit",clickedElement.attr("data-limit")),post_data.data.follows_min_limit=clickedElement.attr("data-limit");break;case"unfollow-source":clickedElement.parent().parent().find("button").html(clickedElement.html()+"<span class='caret'></span>"),clickedElement.parent().parent().find("button").attr("data-source",clickedElement.attr("data-source")),post_data.data.unfollow_source=clickedElement.attr("data-source");break;case"follow_speed":var value=speed,elementContainer=angular.element(document.getElementById("follow-range"));switch(value){case"1":var selectedSpeed="slow",removeSpeeds="medium fast";break;case"2":var selectedSpeed="medium",removeSpeeds="slow fast";break;case"3":var selectedSpeed="fast",removeSpeeds="slow medium"}var elementContainer=angular.element(document.getElementById("follow-range")),selectedSpan=elementContainer.find("."+selectedSpeed),currentSpeed=elementContainer.find(".displayed");if("1"==selectedSpan.attr("data-valid"))if(void 0!=currentSpeed.attr("data-speed-value")&&currentSpeed.attr("data-speed-value")!=value)currentSpeed.removeClass("displayed"),elementContainer.removeClass(removeSpeeds).addClass(selectedSpeed),elementContainer.find(".input-range").removeClass(removeSpeeds).addClass(selectedSpeed),selectedSpan.addClass("displayed"),post_data.data.follow_speed=selectedSpeed,angular.element(document.getElementById("right-sidebar-follow-speed")).html(selectedSpan.html());else var cancelRequest=!0;else{var modal=angular.element(document.getElementById("upgrade-modal"));modal.hasClass("displayed")||modal.addClass("displayed");var inputRange=elementContainer.find(".input-range");inputRange.removeClass("slow medium fast"),inputRange.addClass(elementContainer.find(".displayed").attr("data-speed")),inputRange.val(elementContainer.find(".displayed").attr("data-speed-value")),inputRange.triggerHandler("change"),angular.element(document.getElementById("follow-upgrade-plan")).addClass("displayed");var cancelRequest=!0}break;case"unfollow_speed":var value=speed;switch(value){case"1":var selectedSpeed="slow",removeSpeeds="medium fast";break;case"2":var selectedSpeed="medium",removeSpeeds="slow fast";break;case"3":var selectedSpeed="fast",removeSpeeds="slow medium"}var elementContainer=angular.element(document.getElementById("unfollow-range")),selectedSpan=elementContainer.find("."+selectedSpeed),currentSpeed=elementContainer.find(".displayed");if("1"==selectedSpan.attr("data-valid"))if(void 0!=currentSpeed.attr("data-speed-value")&&currentSpeed.attr("data-speed-value")!=value)currentSpeed.removeClass("displayed"),elementContainer.removeClass(removeSpeeds).addClass(selectedSpeed),elementContainer.find(".input-range").removeClass(removeSpeeds).addClass(selectedSpeed),selectedSpan.addClass("displayed"),post_data.data.unfollow_speed=selectedSpeed,angular.element(document.getElementById("right-sidebar-unfollow-speed")).html(selectedSpan.html());else var cancelRequest=!0;else{var modal=angular.element(document.getElementById("upgrade-modal"));modal.hasClass("displayed")||modal.addClass("displayed");var inputRange=elementContainer.find(".input-range");inputRange.removeClass("slow medium fast"),inputRange.addClass(elementContainer.find(".displayed").attr("data-speed")),inputRange.val(elementContainer.find(".displayed").attr("data-speed-value")),inputRange.triggerHandler("change"),angular.element(document.getElementById("unfollow-upgrade-plan")).addClass("displayed");var cancelRequest=!0}break;case"follow_no_private":clickedElement.parent().find(".active").removeClass("active"),clickedElement.addClass("active"),post_data.data.follow_no_private=parseInt(clickedElement.attr("data-private"));break;case"sleep_status":clickedElement.parent().find(".active").removeClass("active"),clickedElement.addClass("active"),post_data.data.sleep_status=parseInt(clickedElement.attr("data-sleep"));break;case"sleep_time":clickedElement.parent().parent().find("button").html(clickedElement.html()+"<span class='caret'></span>"),clickedElement.parent().parent().find("button").attr("data-sleep",clickedElement.attr("data-sleep"));var sleepTime=parseInt(clickedElement.attr("data-sleep"));post_data.data.sleep_start_min=sleepTime,sleepTime<=23?post_data.data.sleep_start_max=sleepTime+1:post_data.data.sleep_start_max=sleepTime+1-24;var sleepDuration=angular.element(document.getElementById("sleep-duration")).attr("data-sleep"),sleepEnd=sleepTime+parseInt(sleepDuration);sleepEnd<=23?(post_data.data.sleep_end_min=sleepEnd,post_data.data.sleep_end_max=sleepEnd+1):(post_data.data.sleep_end_min=sleepEnd-24,post_data.data.sleep_end_max=sleepEnd+1-24);break;case"sleep_duration":clickedElement.parent().parent().find("button").html(clickedElement.html()+"<span class='caret'></span>"),clickedElement.parent().parent().find("button").attr("data-sleep",clickedElement.attr("data-sleep"));var sleepTime=parseInt(angular.element(document.getElementById("sleep-time")).attr("data-sleep")),sleepDuration=parseInt(clickedElement.attr("data-sleep")),sleepEnd=sleepTime+sleepDuration;sleepEnd<=23?(post_data.data.sleep_end_min=sleepEnd,post_data.data.sleep_end_max=sleepEnd+1):(post_data.data.sleep_end_min=sleepEnd-24,post_data.data.sleep_end_max=sleepEnd+1-24);break;case"like_status":clickedElement.hasClass("active")?(clickedElement.removeClass("active"),post_data.data.like_status="0"):(clickedElement.addClass("active"),post_data.data.like_status="1")}cancelRequest?angular.element(document.getElementById("loader")).removeClass("loading"):$http.post("index.php?route=account/setting/edit",post_data).success(function(data){data.redirect&&(window.location=data.redirect),angular.element(document.getElementById("loader")).removeClass("loading")})}function updateSetting(selectedOption,setting){$timeout(function(){var dropdown=angular.element(document.getElementById(setting)).find(".dropdown"),options=dropdown.find(".dropdown-menu li");switch(setting){case"follow-limit-container":if(parseInt(dropdown.find(".dropdown-toggle").html())!=selectedOption)for(var i=0;i<options.length;i++)selectedOption==options.eq(i).html()&&options.eq(i).trigger("click");break;case"unfollow-limit-container":var selectedValue=selectedOption.replace(/^\D+/g,"");""==selectedValue&&(selectedValue=0);var dropdownVal=dropdown.find(".dropdown-toggle").attr("data-limit");if(dropdownVal!=selectedValue)for(var i=0;i<options.length;i++)selectedValue==options.eq(i).attr("data-limit")&&options.eq(i).trigger("click");break;case"unfollow-source-container":var dropdownVal=dropdown.find(".dropdown-toggle").attr("data-source");if(dropdownVal!=selectedOption)for(var i=0;i<options.length;i++)selectedOption==options.eq(i).attr("data-source")&&options.eq(i).trigger("click");break;case"sleep-time-container":var dropdown=angular.element(document.getElementById(setting)).find(".dropup"),options=dropdown.find(".dropdown-menu li"),selectedValue=selectedOption.replace(/^\D+/g,"");""==selectedValue&&(selectedValue=0);var dropdownVal=dropdown.find(".dropdown-toggle").attr("data-sleep");if(dropdownVal!=selectedValue)for(var i=0;i<options.length;i++)selectedValue==options.eq(i).attr("data-sleep")&&options.eq(i).trigger("click");case"sleep-duration-container":var dropdown=angular.element(document.getElementById(setting)).find(".dropup"),options=dropdown.find(".dropdown-menu li"),selectedValue=selectedOption.replace(/^\D+/g,"");""==selectedValue&&(selectedValue=0);var dropdownVal=dropdown.find(".dropdown-toggle").attr("data-sleep");if(dropdownVal!=selectedValue)for(var i=0;i<options.length;i++)selectedValue==options.eq(i).attr("data-sleep")&&options.eq(i).trigger("click")}},0)}function accountStatus($event,accountId){$rootScope.$broadcast("changeAccountStatus",$event,accountId)}var vm=this;vm.changeSettings=changeSettings,vm.updateSetting=updateSetting,vm.accountStatus=accountStatus,$rootScope.$on("changeSettings",function(e,$event,endpoint,id){vm.changeSettings($event,endpoint,id)})}angular.module("instag-app").controller("SettingsTabController",SettingsTabController),SettingsTabController.$inject=["$scope","$http","$timeout","$rootScope"]}(),function(){function SourceInterestsController($scope,$http,$compile,$rootScope){function activateSource($event){vm.selectedSourcesFlag=angular.element(document.getElementById("source-categories")).find(".active").length;var clickedElement=angular.element($event.currentTarget),accountId=angular.element(document.getElementById("left-sidebar")).find(".instagram-accounts .current-account").attr("data-id"),sourceId=clickedElement.attr("data-source-id");if(angular.element(document.getElementById("source-categories")).hasClass("disabled")){if(clickedElement.hasClass("active")){angular.element(document.getElementById("loader")).addClass("loading");var post_data={account_id:accountId,source_interest_id:sourceId,selected:0};$http.post("index.php?route=account/account/source_interest",post_data).success(function(data){if(data.success){clickedElement.removeClass("active");var sourcesCount=parseInt(angular.element(document.getElementById("users-notification-count")).html());sourcesCount--,angular.element(document.getElementById("tab-header-middle")).find(".users .notification-count").html(sourcesCount),vm.selectedSourcesFlag--,vm.selectedSourcesFlag<5&&angular.element(document.getElementById("source-categories")).removeClass("disabled"),vm.checkRequiredSources(),angular.element(document.getElementById("loader")).removeClass("loading")}})}}else{if(angular.element(document.getElementById("loader")).addClass("loading"),clickedElement.hasClass("active"))var selectedStatus=0;else var selectedStatus=1;var post_data={account_id:accountId,source_interest_id:sourceId,selected:selectedStatus};$http.post("index.php?route=account/account/source_interest",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.success){var sourcesCount=parseInt(angular.element(document.getElementById("users-notification-count")).html());selectedStatus?(clickedElement.addClass("active"),sourcesCount++,vm.selectedSourcesFlag++,5==vm.selectedSourcesFlag&&angular.element(document.getElementById("source-categories")).addClass("disabled"),changeButtonLanguage(".users-steps",!1),angular.element(document.getElementById("rocket-item")).checkIcon(".right-sidebar-users i")):(clickedElement.removeClass("active"),sourcesCount--,vm.selectedSourcesFlag--,angular.element(document.getElementById("rocket-item")).uncheckIcon(".right-sidebar-users i")),vm.checkRequiredSources(),angular.element(document.getElementById("tab-header-middle")).find(".users .notification-count").html(sourcesCount)}angular.element(document.getElementById("loader")).removeClass("loading")})}}function checkUsersList(listContainer){var rocketItem=angular.element(document.getElementById("rocket-item"));if(0==listContainer.children().length)switch(listContainer.attr("id")){case"user-sources-list":checkRequiredSources();break;case"whitelist-users-list":var whitelistSkip=angular.element(document.getElementById("start-kickoff-button")).attr("data-skip-whitelist");whitelistSkip?(rocketItem.checkIcon(".right-sidebar-whitelist i"),changeButtonLanguage(".whitelist-steps",!1)):(rocketItem.uncheckIcon(".right-sidebar-whitelist i"),changeButtonLanguage(".whitelist-steps",!0)),checkRequiredSources();break;case"hashtag-sources-list":rocketItem.uncheckIcon(".right-sidebar-tags i"),changeButtonLanguage(".tags-steps",!0);break;case"locations-sources-list":rocketItem.uncheckIcon(".right-sidebar-locations i"),changeButtonLanguage(".locations-steps",!0)}else switch(listContainer.attr("id")){case"user-sources-list":rocketItem.checkIcon(".right-sidebar-users i"),checkRequiredSources(),changeButtonLanguage(".users-steps",!1);break;case"whitelist-users-list":rocketItem.checkIcon(".right-sidebar-whitelist i"),checkRequiredSources(),changeButtonLanguage(".whitelist-steps",!1);break;case"hashtag-sources-list":rocketItem.checkIcon(".right-sidebar-tags i"),changeButtonLanguage(".tags-steps",!1);break;case"locations-sources-list":rocketItem.checkIcon(".right-sidebar-locations i"),changeButtonLanguage(".locations-steps",!1)}}function checkRequiredSources(){var usersSources=angular.element(document.getElementById("user-sources-list")).children(),sourcesInterest=angular.element(document.getElementById("source-categories")).find(".row .active"),whitelistSources=angular.element(document.getElementById("whitelist-users-list")).children(),rightSidebarBtn=angular.element(document.getElementById("start-kickoff-button")),tabsBtn=angular.element(document.getElementById("tab-body-middle")).find(".start-account-button"),whitelistSkip=rightSidebarBtn.attr("data-skip-whitelist");if((usersSources.length||sourcesInterest.length)&&(whitelistSources.length||whitelistSkip))rightSidebarBtn.removeAttr("disabled").removeClass("disabled-users disabled-whitelist"),tabsBtn.removeAttr("disabled").removeClass("disabled-users disabled-whitelist"),rightSidebarBtn.html(rightSidebarBtn.attr("data-start-account")),tabsBtn.html(tabsBtn.attr("data-start-account")),tabsBtn.removeClass("hide");else if(usersSources.length&&sourcesInterest.length||!whitelistSources.length&&!whitelistSkip)if(!usersSources.length&&!sourcesInterest.length||whitelistSources.length&&whitelistSkip)rightSidebarBtn.attr("disabled","true").removeClass("disabled-users disabled-whitelist"),tabsBtn.attr("disabled","true").removeClass("disabled-users disabled-whitelist"),rightSidebarBtn.html(rightSidebarBtn.attr("data-start-account")),tabsBtn.html(tabsBtn.attr("data-start-account")),usersSources.length||sourcesInterest.length||(angular.element(document.getElementById("rocket-item")).uncheckIcon(".right-sidebar-users i"),changeButtonLanguage(".users-steps",!0)),tabsBtn.removeClass("hide");else{rightSidebarBtn.removeAttr("disabled"),tabsBtn.removeAttr("disabled"),rightSidebarBtn.html(rightSidebarBtn.attr("data-disabled-whitelist")),tabsBtn.html(tabsBtn.attr("data-disabled-whitelist")),rightSidebarBtn.addClass("disabled-whitelist"),tabsBtn.addClass("disabled-whitelist");var currentTab=angular.element(document.getElementById("tab-dropdown-middle")).find(".current-tab");"whitelist"==currentTab.attr("data-tab")&&tabsBtn.addClass("hide")}else{rightSidebarBtn.removeAttr("disabled"),tabsBtn.removeAttr("disabled"),rightSidebarBtn.html(rightSidebarBtn.attr("data-disabled-users")),tabsBtn.html(tabsBtn.attr("data-disabled-users")),rightSidebarBtn.addClass("disabled-users"),tabsBtn.addClass("disabled-users");var currentTab=angular.element(document.getElementById("tab-dropdown-middle")).find(".current-tab");"users"==currentTab.attr("data-tab")&&tabsBtn.addClass("hide")}}function changeButtonLanguage(cardClass,getStarted){var cardButton=angular.element(document.getElementById("kickoff")).find(cardClass+" .gold-button");getStarted?cardButton.html(cardButton.attr("data-get-started")):cardButton.html(cardButton.attr("data-add-more"))}function checkIcon(element){return this.find(element).removeClass("fa-chevron-right").addClass("fa-check-circle"),this}function uncheckIcon(element){return this.find(element).removeClass("fa-check-circle").addClass("fa-chevron-right"),this}var vm=this;vm.activateSource=activateSource,vm.checkUsersList=checkUsersList,vm.checkRequiredSources=checkRequiredSources,vm.changeButtonLanguage=changeButtonLanguage,vm.selectedSourcesFlag=0,angular.element.prototype.checkIcon=checkIcon,angular.element.prototype.uncheckIcon=uncheckIcon,$rootScope.$on("checkUsersList",function(e,listContainer){vm.checkUsersList(listContainer)})}angular.module("instag-app").controller("SourceInterestsController",SourceInterestsController),SourceInterestsController.$inject=["$scope","$http","$compile","$rootScope"]}(),function(){function TabsController(timeAgoService,chartService,$scope,$timeout,$http,$compile,$rootScope){function changeTab($event,tabGroup){var clickedElement=angular.element($event.currentTarget);if(clickedElement.hasClass("current-tab")||window.scrollTo(0,0),"middle"==tabGroup)var tabHeader=angular.element(document.getElementById("tab-header-middle")),tabBody=angular.element(document.getElementById("tab-body-middle"));else var tabHeader=angular.element(document.getElementById("tab-header-sidebar")),tabBody=angular.element(document.getElementById("tab-body-sidebar"));clickedElement.hasClass("request")&&(clickedElement.removeClass("request"),vm.requestActivity("activity"));var currentClass=clickedElement.attr("data-tab");if(tabHeader.find(".current-tab").removeClass("current-tab"),tabHeader.find("."+currentClass).addClass("current-tab"),tabBody.find(".current-tab").removeClass("current-tab"),tabBody.find("#"+currentClass).addClass("current-tab"),"dashboard"==clickedElement.attr("data-tab")&&vm.changeHeight(),window.innerWidth<1200&&"middle"==tabGroup){var clickedClass=clickedElement.attr("data-tab"),tabLanguage=clickedElement.attr("data-tab-language"),dropdown=angular.element(document.getElementById("tab-dropdown-middle"));dropdown.find(".current-tab").removeClass("current-tab"),clickedElement.attr("data-tab")?(dropdown.find("."+clickedClass).addClass("current-tab"),dropdown.find("button").html('<i class="fa fa-bars"></i> '+tabLanguage)):dropdown.find("button").html('<i class="fa fa-bars"></i> '+clickedElement.html());var startAccountButton=angular.element(document.getElementById("start-kickoff-button"));
"users"==clickedElement.attr("data-tab")&&startAccountButton.hasClass("disabled-users")?angular.element(document.getElementById("tab-body-middle")).find(".row .start-account-button").addClass("hide"):"whitelist"==clickedElement.attr("data-tab")&&startAccountButton.hasClass("disabled-whitelist")?angular.element(document.getElementById("tab-body-middle")).find(".row .start-account-button").addClass("hide"):angular.element(document.getElementById("tab-body-middle")).find(".row .start-account-button").removeClass("hide")}}function billingTab($event){if(vm.changeTab($event,"middle"),!window.billingFlag){angular.element(document.getElementById("loader")).addClass("loading"),window.billingFlag=!0;var accountId=angular.element(document.getElementById("left-sidebar")).find(".current-account").attr("data-id"),post_data={account_id:accountId};$http.post("index.php?route=account/billing",post_data).success(function(data){var scope=angular.element(document.getElementById("billing")).scope();angular.element(document.getElementById("billing")).append($compile(data)(scope)),$rootScope.$$listeners.updateBilling.length>0&&$rootScope.$$listeners.updateBilling.splice(1),$rootScope.$$listeners.updateSpeed.length>0&&$rootScope.$$listeners.updateSpeed.splice(1),(angular.element(window).innerWidth()>760||"0"==angular.element(document.getElementById("billing")).find(".has-speed").attr("data-selected-product"))&&vm.uncollapseBilling(!0),angular.element(document.getElementById("loader")).removeClass("loading")})}}function uncollapseBilling(hasSpeed){var speedContainer=angular.element(document.getElementById("speeds")),productContainer=angular.element(document.getElementById("products")),selected=angular.element(document.getElementById("billing")).find(".has-speed").attr("data-selected-product");if("0"==selected){var default_speed=speedContainer.children().eq(0),default_billing=productContainer.find("#category-"+default_speed.attr("data-category-id")).children().eq(0);vm.updateSpeed({currentTarget:default_speed}),vm.updateBilling({currentTarget:default_billing})}else{switch(selected){case"1":case"2":case"3":var category=".category-1";break;case"4":case"5":case"6":var category=".category-2";break;case"7":case"8":case"9":var category=".category-3"}var product=".product-"+selected;$timeout(function(){speedContainer.find(category).trigger("click"),productContainer.find(product).trigger("click")})}vm.collapse()}function collapse(){var collapse=angular.element(document.getElementById("billing")).find(".collapse");collapse.addClass("opened"),collapse.find(".collapse-header").removeClass("has-speed has-billing")}function requestActivity(endpoint){var feedContainer="#activity";if("activity"==endpoint)var route="activity";else if("followback"==endpoint)var route="event_activity";if(window.innerWidth>730)var feed=angular.element(document.getElementById("right-sidebar")).find(feedContainer),scrollContainer=angular.element(document.getElementById("right-sidebar-content"));else var feed=angular.element(document.getElementById("tab-body-middle")).find(feedContainer),scrollContainer=angular.element(window);feed.find(".activity-content").empty();var refreshFeed=feed.find(".refresh-act-feed");if(!refreshFeed.hasClass("loading-button")){feed.find(".refresh-act-feed").addClass("loading-button");var id=angular.element(document.getElementById("left-sidebar")).find(".current-account").attr("data-id"),post_data={account_id:id,limit:12};$http.post("index.php?route=account/"+route+"/html",post_data).success(function(data){data.redirect&&(window.location=data.redirect),feed.find(".activity-content").append($compile(data)($scope));for(var time="",offset=angular.element(document.getElementById("history-content")).attr("data-offset"),i=0;i<feed.find(".activity-item .item-content small").length;i++){var added=new Date(feed.find(".activity-content").children().eq(i).find(".item-content small").attr("data-time"));time=vm.timeAgo(added,offset),feed.find(".activity-item .item-content small").eq(i).html(time)}if(feed.find(".activity-item").length<6&&feed.find(".activity-item").length>0){feed.find("#loading-activity").remove();var noActivity='<div class="sidebar-item no-activity-item"><img src="catalog/view/theme/default/image/no-activity.jpg"></div>';feed.find(".activity-content").append($compile(noActivity)($scope))}feed.find(".refresh-act-feed").removeClass("loading-button"),scrollContainer.bind("scroll",function(e){e.preventDefault();var scrolledElement=scrollContainer,scrolled=(scrolledElement.scrollTop()||window.pageYOffset)-(scrolledElement.clientTop||0);if(scrolled+=scrollContainer.innerHeight(),scrolled>feed.innerHeight()&&!feed.hasClass("loading-activities")&&0==feed.find(".no-activity-item").length){feed.addClass("loading-activities");var lastKey=angular.element(feed.find(".last-key")).last().attr("data-key");if(lastKey.length){var id=angular.element(document.getElementById("left-sidebar")).find(".current-account").attr("data-id"),post_data={account_id:id,limit:12,last_evaluated_key:lastKey},endpoint=angular.element(document.getElementById("activity")).find(".active").attr("data-feed");if("activity"==endpoint)var route="activity";else if("followback"==endpoint)var route="event_activity";$http.post("index.php?route=account/"+route+"/html",post_data).success(function(data){data.redirect&&(window.location=data.redirect),feed.find("#loading-activity").remove();var activitiesLength=feed.find(".activity-item .item-content small").length;feed.find(".activity-content").append($compile(data)($scope));for(var time="",offset=angular.element(document.getElementById("history-content")).attr("data-offset"),i=activitiesLength;i<feed.find(".activity-item .item-content small").length;i++){var added=new Date(feed.find(".activity-content .activity-item").eq(i).find(".item-content small").attr("data-time"));time=vm.timeAgo(added,offset),feed.find(".activity-item .item-content small").eq(i).html(time)}feed.removeClass("loading-activities")})}else{angular.element(document.getElementById("loading-activity")).css("opacity","0").remove(),feed.removeClass("loading-activities");var noActivity='<div class="sidebar-item no-activity-item"><img src="catalog/view/theme/default/image/no-activity.jpg"></div>';feed.find(".activity-content").append(noActivity)}}})})}}function updateFeed($event){if($event){var clickedElement=angular.element($event.currentTarget),endpoint=clickedElement.parent().find(".active").attr("data-feed");requestActivity(endpoint)}}function switchBtns($event){var clickedElement=angular.element($event.target);clickedElement.parent().find(".active").removeClass("active"),clickedElement.addClass("active")}function updateSpeed($event){$rootScope.$broadcast("updateSpeed",$event)}function updateBilling($event){$rootScope.$broadcast("updateBilling",$event)}var vm=this;vm.changeTab=changeTab,vm.billingTab=billingTab,vm.uncollapseBilling=uncollapseBilling,vm.collapse=collapse,vm.requestActivity=requestActivity,vm.updateFeed=updateFeed,vm.switchBtns=switchBtns,vm.updateSpeed=updateSpeed,vm.updateBilling=updateBilling,vm.timeAgo=timeAgoService.timeAgo,vm.changeHeight=chartService.changeHeight,$rootScope.$on("requestActivity",function(e,endpoint){requestActivity(endpoint)}),$rootScope.$on("updateFeed",function(e,$event){updateFeed($event)}),$rootScope.$on("switchBtns",function(e,$event){switchBtns($event)}),$rootScope.$on("changeTab",function(e,event,tabGroup){changeTab(event,tabGroup)})}angular.module("instag-app").controller("TabsController",TabsController),TabsController.$inject=["timeAgoService","chartService","$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function TagsSourcesController($scope,$timeout,$http,$compile){}angular.module("instag-app").controller("TagsSourcesController",TagsSourcesController),TagsSourcesController.$inject=["$scope","$timeout","$http","$compile"]}(),function(){function TopSourcesController($scope,$compile,$http,$rootScope){function getSources(accountId,dateRange,$event){var dateRange=dateRange||"-30 days",$event=$event||!1,post_data={account_id:accountId,date_start:dateRange},sourcesContainer=angular.element(document.getElementById("top-sources")).find(".card-content");sourcesContainer.empty().append('<i class="fa fa-refresh fa-spin fa-3x fa-fw"></i>'),$http.post("index.php?route=account/report_source_total",post_data).success(function(data){if(sourcesContainer.empty().append($compile(data)($scope)),$event){var clicked=angular.element($event.currentTarget);clicked.parent().parent().find("#top-sources-range").html(clicked.html()+' <span class="caret pull-right"></span>')}for(var sourcesTable=sourcesContainer.find("#sources-table .table-body"),usersListContainer=angular.element(document.getElementById("user-sources-list")),tagsListContainer=angular.element(document.getElementById("hashtag-sources-list")),locationsListContainer=angular.element(document.getElementById("locations-sources-list")),i=0;i<sourcesTable.children().length;i++){var sourceType=sourcesTable.children().eq(i).find(".users-column").attr("data-type"),sourceName=sourcesTable.children().eq(i).find(".users-column").attr("data-source");switch(sourceType){case"user":usersListContainer.find("."+sourceName).length&&sourcesTable.children().eq(i).find(".users-column").addClass("active-source");break;case"tag":tagsListContainer.find("."+sourceName).length&&sourcesTable.children().eq(i).find(".users-column").addClass("active-source");break;case"location":locationsListContainer.find("."+sourceName.substring(1)).length&&sourcesTable.children().eq(i).find(".users-column").addClass("active-source")}}})}var vm=this;vm.getSources=getSources,$rootScope.$on("getSources",function(e,accountId){vm.getSources(accountId)})}angular.module("instag-app").controller("TopSourcesController",TopSourcesController),TopSourcesController.$inject=["$scope","$compile","$http","$rootScope"]}(),function(){function UsersSourcesController($scope,$timeout,$http,$compile){}angular.module("instag-app").controller("UsersSourcesController",UsersSourcesController),UsersSourcesController.$inject=["$scope","$timeout","$http","$compile"]}(),function(){function WhitelistController(modalsService,$scope,$timeout,$http,$compile,$rootScope){function setWhitelistLimit($event){var $event=$event||!1;if($event){var clickedElement=angular.element($event.currentTarget);angular.element(document.getElementById("whitelist-limit")).attr("data-limit",clickedElement.html())}else{var clickedElement=angular.element(document.getElementById("select-whitelist"));angular.element(document.getElementById("whitelist-limit")).attr("data-limit",clickedElement.val())}vm.displayWarning("warning-whitelist")}function importWhitelist(id){angular.element(document.getElementById("loader")).addClass("loading"),angular.element(document.getElementById("warning-whitelist")).removeClass("displayed");var limit=angular.element(document.getElementById("whitelist-limit")).attr("data-limit"),post_data={account_id:id,limit:limit};$http.post("index.php?route=account/instagram/import_whitelist_users",post_data).success(function(data){if(data.redirect&&(window.location=data.redirect),data.data){for(var addedUsers="",i=0;i<data.data.length;i++)addedUsers+='<div class="user-list" ng-controller="RemoveController as remove">',addedUsers+='<a href="http://www.instagram.com/'+data.data[i].username+'" target="blank">',addedUsers+='<h4><img src="catalog/view/theme/default/image/dashboard/default_user.jpg" />',addedUsers+=data.data[i].username+"</h4></a>",addedUsers+='<button class="gold-button" ng-click="remove.removeFromList($event,\''+id+"','remove_whitelist_users','"+data.data[i].id+"')\">X</button>",addedUsers+="</div>";if(angular.element(document.getElementById("whitelist-users-list")).append($compile(addedUsers)($scope)),angular.element(document.getElementById("content")).attr("data-kickoff")){angular.element(document.getElementById("rocket-item")).find(".right-sidebar-whitelist i").removeClass("fa-chevron-right").addClass("fa-check-circle");var cardButton=angular.element(document.getElementById("kickoff")).find(".card").eq(0).find(".gold-button");cardButton.html(cardButton.attr("data-add-more"))}var usersCount=parseInt(angular.element(document.getElementById("whitelist-notification-count")).html());usersCount+=data.data.length,angular.element(document.getElementById("whitelist-count")).html(usersCount),angular.element(document.getElementById("whitelist-notification-count")).html(usersCount),angular.element(document.getElementById("tab-dropdown-middle")).find(".whitelist .notification-count").html(usersCount)}checkingFlag=!1,angular.element(document.getElementById("loader")).removeClass("loading")})}function checkWhitelist(id){angular.element(document.getElementById("loader")).addClass("loading"),checkingFlag||(angular.element(document.getElementById("whitelist-users-list")).children().length>0?(checkingFlag=!0,vm.clearList(id,"whitelist_users",vm.importWhitelist),vm.closeModal()):(vm.importWhitelist(id),vm.closeModal()))}function displayWarning(container){modalsService.displayWarning(container)}function clearList(id,list,callback){$rootScope.$broadcast("clearList",id,list,callback)}function closeModal(){$rootScope.$broadcast("closeModal")}var vm=this;vm.setWhitelistLimit=setWhitelistLimit,vm.importWhitelist=importWhitelist,vm.checkWhitelist=checkWhitelist,vm.displayWarning=displayWarning,vm.clearList=clearList,vm.closeModal=closeModal;var checkingFlag=!1}angular.module("instag-app").controller("WhitelistController",WhitelistController),WhitelistController.$inject=["modalsService","$scope","$timeout","$http","$compile","$rootScope"]}(),function(){function chartService(){function changeHeight(){if(window.innerWidth>730){var influence=angular.element(document.getElementById("my-influence")),chartCard=angular.element(document.getElementById("chart-card"));influence.innerHeight("auto"),chartCard.innerHeight("auto"),influence.innerHeight()>chartCard.innerHeight()?chartCard.innerHeight(influence.innerHeight()):influence.innerHeight(chartCard.innerHeight())}}function showChart(){if(angular.element(document.getElementById("chart-data")).length){var dataContainer=angular.element(document.getElementById("chart-data")),graph=[],labels=[],datasets=[],alpha=3,stepSize=0,maxValue=0;yLimit=0;for(var i=0;i<dataContainer.children().length;i++){if(graph[i]={followers:[]},i>0)for(var p=1;p<reportData.children().length;p++)graph[i].followers.push(null);for(var reportData=dataContainer.children().eq(i),p=0;p<reportData.children().length;p++){labels.indexOf(reportData.children().eq(p).data("date"))==-1&&labels.push(reportData.children().eq(p).data("date")),graph[i].followers.push(reportData.children().eq(p).data("followers"));var o=p+1;reportData.children().eq(o)&&stepSize<Math.abs(reportData.children().eq(o).data("followers"))-Math.abs(reportData.children().eq(p).data("followers"))&&(stepSize=Math.abs(Math.abs(reportData.children().eq(o).data("followers"))-Math.abs(reportData.children().eq(p).data("followers")))),yLimit<reportData.children().eq(p).data("followers")&&(yLimit=reportData.children().eq(p).data("followers"))}datasets.push({label:dataContainer.children().eq(i).data("key"),data:graph[i].followers,backgroundColor:"rgba(129,55,176,0."+alpha+")",lineTension:.1,borderWidth:1,borderColor:"rgba(0,0,0,0.3)",pointBorderColor:"rgba(129,55,176,0.7)",pointBackgroundColor:"rgba(129,55,176,1)"}),alpha+=3}stepSize=100*Math.ceil(stepSize/100),maxValue=stepSize*(reportData.children().length+2);for(var condition=!1;!condition;)maxValue/yLimit>2.1&&maxValue-stepSize>yLimit?maxValue-=stepSize:condition=!0;if(document.getElementById("chart")){var ctx=document.getElementById("chart");window.graphic=new Chart(ctx,{type:"line",scales:{position:"left",height:250},data:{labels:labels,datasets:datasets},options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{scaleOverride:!0,stepSize:stepSize,scaleStepWidth:Math.ceil(maxValue/stepSize)}}]}}})}}}return{changeHeight:changeHeight,showChart:showChart}}angular.module("instag-app").service("chartService",chartService)}(),function(){function checkStatusService(){function checkStatus(message){var currentAccount=angular.element(document.getElementById("left-sidebar")).find(".current-account"),statusIcon=currentAccount.find(".account-status"),statusSquare=currentAccount.find(".account-square-status"),rightSidebarIcon=angular.element(document.getElementById("account")).find(".run-status .account-status-icon"),removeClasses="reconnect kickoff stopped started start stop disabled expired";if(angular.element(window).innerWidth()<1200)var headerStatus=angular.element(document.getElementById("logo-u-container")).find(".account-item .account-status");if("invalid_token"==message){currentAccount.attr("data-false","true"),statusIcon.removeClass(removeClasses).addClass("reconnect"),statusSquare.removeClass(removeClasses).addClass("reconnect").attr("data-action","stopped"),rightSidebarIcon.removeClass("fa-started fa-stopped fa-expired").addClass("fa-reconnect"),currentAccount.find(".account-square-status").attr("data-tooltip",rightSidebarIcon.attr("data-tooltip")),angular.element(document.getElementById("reconnect-modal")).css("z-index","3"),angular.element(document.getElementById("right-sidebar")).css("z-index","2"),headerStatus&&headerStatus.removeClass(removeClasses).addClass("reconnect");var username=currentAccount.find(".sidebar-item-title span").attr("data-username"),modal=angular.element(document.getElementById("reconnect-modal"));modal.addClass("displayed"),modal.find(".modal-header p span").html("@"+username),modal.find("#instagram_username").val(username)}else if("no_activity"==message)currentAccount.attr("data-false","true"),statusIcon.removeClass(removeClasses).addClass("disabled"),statusSquare.removeClass(removeClasses).addClass("disabled").attr("data-action","disabled"),statusSquare.attr("data-tooltip",rightSidebarIcon.attr("data-tooltip")),headerStatus&&headerStatus.removeClass(removeClasses).addClass("disabled");else if("expired"==message){angular.element(document.getElementById("expired-modal")).css("z-index","3"),angular.element(document.getElementById("right-sidebar")).css("z-index","2");var modal=angular.element(document.getElementById("expired-modal"));modal.addClass("displayed"),currentAccount.attr("data-false","true"),statusIcon.removeClass(removeClasses).addClass("expired"),statusSquare.removeClass(removeClasses).addClass("expired").attr("data-action","expired"),statusSquare.attr("data-tooltip",rightSidebarIcon.attr("data-tooltip")),rightSidebarIcon.removeClass("fa-started fa-stopped fa-reconnect").addClass("fa-expired"),headerStatus&&headerStatus.removeClass(removeClasses).addClass("expired")}else if(""==message||"temp_block"==message){var action=angular.element(document.getElementById("change-status-btn")).attr("data-action");"start"==action||"expired"==action?(currentAccount.attr("data-false",""),statusIcon.removeClass(removeClasses).addClass("stopped"),statusSquare.removeClass(removeClasses).addClass("stopped").attr("data-action","stopped"),rightSidebarIcon.removeClass("fa-started fa-reconnect fa-expired").addClass("fa-stopped"),headerStatus&&headerStatus.removeClass(removeClasses).addClass("stopped")):"stop"==action&&(currentAccount.attr("data-false",""),statusIcon.removeClass(removeClasses).addClass("started"),statusSquare.removeClass(removeClasses).addClass("started").attr("data-action","started"),rightSidebarIcon.removeClass("fa-reconnect fa-stopped fa-expired").addClass("fa-started"),headerStatus&&headerStatus.removeClass(removeClasses).addClass("started"))}}return{checkStatus:checkStatus}}angular.module("instag-app").factory("checkStatusService",checkStatusService)}(),function(){function modalsService(){function displayWarning(container){angular.element(document.getElementById(container)).addClass("displayed")}return{displayWarning:displayWarning}}angular.module("instag-app").factory("modalsService",modalsService)}(),function(){function timeAgoService(){function timeAgo(added,offset){var now=new Date,nowOffset=now.getTime()+6e4*now.getTimezoneOffset(),addedOffset=added-1e3*parseInt(offset),time=Math.round((nowOffset-addedOffset)/1e3);switch(!0){case time<60:time=document.getElementById("timeago-seconds").dataset.language;break;case time>=60&&time<120:time=document.getElementById("timeago-minute").dataset.language;break;case time>=120&&time<3600:time=Math.round(time/60).toString()+document.getElementById("timeago-minutes").dataset.language;break;case time>=3600&&time<7200:time=document.getElementById("timeago-hour").dataset.language;break;case time>=7200&&time<86400:time=Math.round(time/60/60).toString()+document.getElementById("timeago-hours").dataset.language;break;case time/60/60>=24&&time/60/60<48:time=document.getElementById("timeago-day").dataset.language;break;case time/60/60>=48:time=Math.round(time/60/60/24).toString()+document.getElementById("timeago-days").dataset.language;break;default:time=""}return time}function historyMarkup(events,singleEvent){var singleEvent=singleEvent||!1,offset=angular.element(document.getElementById("history-content")).attr("data-offset"),items="",time="";if(singleEvent){events.length=1;var added=new Date(events.date_added),code=events.code,title=events.title,description=events.description}for(var i=0;i<events.length&&i<15;i++){if(events.length>1)var added=new Date(events[i].date_added),code=events[i].code,title=events[i].title,description=events[i].description;time=timeAgo(added,offset),items+='<div class="history-item sidebar-item">',items+='<i class="fa fa-event-'+code+' history-icon"></i>',items+='<div class="item-content">',items+="<h4>"+title+"</h4>",items+="<p>"+description+"</p>",items+='<small data-time="'+added+'">'+time+"</small>",items+="</div>",items+="</div>"}return items}return{timeAgo:timeAgo,historyMarkup:historyMarkup}}angular.module("instag-app").factory("timeAgoService",timeAgoService)}(),function(){function TooltipsController($scope,$rootScope){function displayTooltip($event){var tooltipContainer=angular.element(document.getElementById("tooltip-container"));if(!tooltipContainer.hasClass("display-tooltip")){vm.triggerHideTooltip(),tooltipContainer.addClass("display-tooltip");var element=angular.element($event.currentTarget),selectedHtmlObj=$event.currentTarget,position=element.attr("data-tooltip-position"),styles=element.attr("data-tooltip-style"),offset=element.attr("data-tooltip-offset")||0,fire=element.attr("data-hide-fire")||"mouseover";switch(position){case"top":var offsetY=selectedHtmlObj.getBoundingClientRect().top-10+"px",offsetX=selectedHtmlObj.getBoundingClientRect().left+selectedHtmlObj.offsetWidth/2+"px";tooltipContainer.css({top:offsetY,left:offsetX,transform:"translateY(-100%)"});break;case"right":var offsetY=selectedHtmlObj.getBoundingClientRect().top+selectedHtmlObj.offsetHeight/2+"px",offsetX=selectedHtmlObj.getBoundingClientRect().right+25+"px";tooltipContainer.css({top:offsetY,left:offsetX,transform:"translatex(0)"});break;case"bottom":var offsetY=selectedHtmlObj.getBoundingClientRect().bottom-10+"px",offsetX=selectedHtmlObj.getBoundingClientRect().left+selectedHtmlObj.offsetWidth/2+"px";tooltipContainer.css({top:offsetY,left:offsetX,transform:"translateY(50%)"});break;case"left":var offsetY=selectedHtmlObj.getBoundingClientRect().top+selectedHtmlObj.offsetHeight/2+"px",offsetX=selectedHtmlObj.getBoundingClientRect().left-10-offset+"px";tooltipContainer.css({top:offsetY,left:offsetX,transform:"translateX(-75%)"})}tooltipContainer.css("display","block");var tooltip=angular.element(document.getElementById("tooltip"));tooltip.html(element.attr("data-tooltip")),tooltip.hasClass(position)||tooltip.removeClass("top right bottom left").addClass(position),tooltip.removeClass("light dark wide").addClass(styles),tooltip.attr("data-hide-fire",fire),setTimeout(function(){tooltip.css({opacity:"1",margin:"0px"})},10)}}function hideTooltip($event){var tooltipContainer=angular.element(document.getElementById("tooltip-container")),tooltip=angular.element(document.getElementById("tooltip"));$event.type&&tooltip.attr("data-hide-fire")==$event.type&&(tooltip.removeAttr("style"),tooltip.removeClass("top right bottom left dark light"),tooltip.html(""),tooltipContainer.removeAttr("style"),tooltipContainer.removeAttr("data-hide-fire"),tooltipContainer.removeClass("display-tooltip"))}function triggerHideTooltip(){var tooltip=angular.element(document.getElementById("tooltip"));if(tooltip.parent().hasClass("display-tooltip")){var tooltipAttr=tooltip.attr("data-hide-fire"),emulatedEvent={type:tooltipAttr};vm.hideTooltip(emulatedEvent)}}function showChat(){$zopim.livechat.window.show()}var vm=this;vm.displayTooltip=displayTooltip,vm.hideTooltip=hideTooltip,vm.triggerHideTooltip=triggerHideTooltip,vm.showChat=showChat,$rootScope.$on("displayTooltip",function(e,$event){vm.displayTooltip($event)}),$rootScope.$on("hideTooltip",function(e,$event){vm.hideTooltip($event)}),$rootScope.$on("triggerHideTooltip",function(){vm.triggerHideTooltip()}),$rootScope.$on("showChat",function(){vm.showChat()})}angular.module("instag-app").controller("TooltipsController",TooltipsController),TooltipsController.$inject=["$scope","$rootScope"]}(),function(){function getEventTarget($event){if($event.currentTarget){var element=angular.element($event.currentTarget);return element}}angular.module("instag-app").factory("getEventTarget",getEventTarget)}();